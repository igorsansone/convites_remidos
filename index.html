<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gerador de Convites - CRO/RS</title>
  <style>
    * {
      box-sizing: border-box;
    }
    
    body {
      background: linear-gradient(135deg, #1a237e 0%, #283593 50%, #1a237e 100%);
      font-family: 'Cormorant Garamond', 'Playfair Display', 'Inter', 'Roboto', serif;
      color: #2c3e50;
      margin: 0;
      padding: 0;
      min-height: 100vh;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 20px;
    }

    /* Welcome Screen */
    .welcome-screen {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      text-align: center;
      color: white;
      padding: 40px 20px;
    }

    .welcome-screen.hidden {
      display: none;
    }

    .logo-container {
      margin-bottom: 40px;
    }

    .logo-container img {
      width: 120px;
      height: 120px;
      filter: brightness(0) invert(1);
    }

    .welcome-title {
      font-size: 3em;
      font-weight: 700;
      margin-bottom: 20px;
      letter-spacing: 2px;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
    }

    .welcome-subtitle {
      font-size: 1.5em;
      margin-bottom: 40px;
      opacity: 0.9;
    }

    .welcome-description {
      max-width: 600px;
      font-size: 1.1em;
      line-height: 1.8;
      margin-bottom: 50px;
      opacity: 0.85;
    }

    .btn-create {
      background: linear-gradient(135deg, #d4af37 0%, #f4d03f 100%);
      color: #1a237e;
      padding: 18px 50px;
      font-size: 1.3em;
      font-weight: 600;
      border: none;
      border-radius: 50px;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(212, 175, 55, 0.3);
    }

    .btn-create:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(212, 175, 55, 0.5);
    }

    /* Editor Screen */
    .editor-screen {
      display: none;
      background: #f5f7fa;
      min-height: 100vh;
      padding: 30px 0;
    }

    .editor-screen.active {
      display: block;
    }

    .header-bar {
      background: white;
      padding: 20px 0;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      margin-bottom: 30px;
    }

    .header-bar .container {
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .brand img {
      width: 50px;
      height: 50px;
    }

    .brand-text h1 {
      font-size: 1.5em;
      color: #1a237e;
      margin: 0;
      font-weight: 700;
    }

    .brand-text p {
      font-size: 0.9em;
      color: #d4af37;
      margin: 0;
    }

    .main-title {
      text-align: center;
      color: #1a237e;
      font-size: 2.5em;
      font-weight: 700;
      margin-bottom: 10px;
      letter-spacing: 1px;
    }

    .main-subtitle {
      text-align: center;
      color: #5c6bc0;
      font-size: 1.3em;
      margin-bottom: 40px;
    }

    .grid-container {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 30px;
      align-items: start;
    }

    @media (max-width: 968px) {
      .grid-container {
        grid-template-columns: 1fr;
      }
    }

    .form-section {
      background: #fff;
      border-radius: 16px;
      padding: 30px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
    }

    .form-section h2 {
      color: #1a237e;
      margin-top: 0;
      font-size: 1.6em;
      margin-bottom: 24px;
      font-weight: 600;
    }

    .section-title {
      color: #1a237e;
      font-size: 1.3em;
      font-weight: 600;
      margin-top: 30px;
      margin-bottom: 15px;
      padding-bottom: 10px;
      border-bottom: 2px solid #e8eaf6;
    }

    .section-title:first-child {
      margin-top: 0;
    }

    .form-group {
      margin-bottom: 20px;
    }

    .form-group label {
      display: block;
      font-weight: 500;
      color: #37474f;
      margin-bottom: 8px;
      font-size: 0.95em;
    }

    .form-group input,
    .form-group textarea,
    .form-group select {
      width: 100%;
      padding: 12px 16px;
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      font-family: 'Inter', 'Roboto', sans-serif;
      font-size: 1em;
      color: #2c3e50;
      transition: all 0.3s;
      background: #fafafa;
    }

    .form-group input:focus,
    .form-group textarea:focus,
    .form-group select:focus {
      outline: none;
      border-color: #5c6bc0;
      background: white;
      box-shadow: 0 0 0 3px rgba(92, 107, 192, 0.1);
    }

    .form-group textarea {
      resize: vertical;
      min-height: 100px;
    }

    .form-group select {
      cursor: pointer;
    }

    /* Template Selector */
    .template-selector {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 15px;
      margin-bottom: 20px;
    }

    .template-option {
      border: 3px solid #e0e0e0;
      border-radius: 12px;
      padding: 20px;
      cursor: pointer;
      transition: all 0.3s;
      text-align: center;
      background: white;
    }

    .template-option:hover {
      border-color: #5c6bc0;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(92, 107, 192, 0.2);
    }

    .template-option.active {
      border-color: #1a237e;
      background: #e8eaf6;
    }

    .template-option input[type="radio"] {
      display: none;
    }

    .template-name {
      font-weight: 600;
      color: #1a237e;
      font-size: 1.1em;
      margin-bottom: 5px;
    }

    .template-description {
      font-size: 0.85em;
      color: #78909c;
    }

    /* Checkbox Group */
    .checkbox-group {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-top: 10px;
    }

    .checkbox-group input[type="checkbox"] {
      width: auto;
      margin: 0;
    }

    .checkbox-group label {
      margin: 0;
      cursor: pointer;
    }

    /* Base Invitation Container */
    .convite-container {
      max-width: 600px;
      margin: 0 auto;
      background: #fff;
      border-radius: 16px;
      box-shadow: 0 4px 24px rgba(0, 0, 0, 0.1);
      padding: 40px;
      position: relative;
    }

    /* Formal Template */
    .convite-container.template-formal {
      border: 4px solid;
      border-image: linear-gradient(135deg, #d4af37 40%, #fffbe8 60%, #d4af37 100%) 1;
      box-shadow: 0 8px 32px rgba(44, 82, 130, 0.12), inset 0 0 0 1px rgba(212, 175, 55, 0.1);
    }

    .convite-container.template-formal:before {
      content: "";
      position: absolute;
      inset: 10px;
      border-radius: 12px;
      pointer-events: none;
      border: 2px dashed #d4af37;
      opacity: 0.6;
    }

    .convite-container.template-formal .header h1 {
      background: linear-gradient(135deg, #1a237e 0%, #283593 50%, #1a237e 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      text-shadow: none;
    }

    /* Modern Template */
    .convite-container.template-modern {
      border-left: 8px solid #1a237e;
      background: linear-gradient(135deg, #ffffff 0%, #f5f7fa 100%);
    }

    /* Classic Template */
    .convite-container.template-classic {
      border: 3px double #d4af37;
      background: #fffef9;
    }

    .convite-container.template-classic:before {
      content: "";
      position: absolute;
      top: 15px;
      left: 15px;
      right: 15px;
      bottom: 15px;
      border: 1px solid #d4af37;
      pointer-events: none;
    }

    /* Minimalist Template */
    .convite-container.template-minimalist {
      border: 1px solid #e0e0e0;
      background: white;
      box-shadow: 0 2px 12px rgba(0, 0, 0, 0.05);
    }

    .header {
      text-align: center;
      margin-bottom: 30px;
    }

    .header .logo-dual {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 30px;
      margin-bottom: 20px;
      padding: 10px;
    }

    .header .logo-dual img {
      width: 80px;
      height: 80px;
      object-fit: contain;
      filter: drop-shadow(0 2px 4px rgba(0,0,0,0.1));
    }

    .header .logo-dual .divider {
      width: 3px;
      height: 80px;
      background: linear-gradient(to bottom, 
        transparent 0%, 
        rgba(212, 175, 55, 0.3) 10%,
        rgba(212, 175, 55, 0.8) 50%, 
        rgba(212, 175, 55, 0.3) 90%,
        transparent 100%);
      box-shadow: 0 0 10px rgba(212, 175, 55, 0.3);
    }

    .header .logo-single {
      display: flex;
      justify-content: center;
      align-items: center;
      margin-bottom: 20px;
      padding: 10px;
    }

    .header .logo-single img {
      width: 80px;
      height: 80px;
      object-fit: contain;
      filter: drop-shadow(0 2px 4px rgba(0,0,0,0.1));
    }

    .header img {
      width: 80px;
      margin-bottom: 15px;
    }

    .header h1 {
      font-size: 2.5em;
      color: #1a237e;
      margin: 0 0 10px 0;
      font-weight: 700;
      letter-spacing: 2px;
      font-family: 'Playfair Display', serif;
    }

    .template-modern .header h1 {
      font-size: 2em;
      font-weight: 600;
    }

    .template-minimalist .header h1 {
      font-size: 1.8em;
      font-weight: 500;
    }

    .sub-title {
      text-align: center;
      color: #5c6bc0;
      font-size: 1.2em;
      font-weight: 500;
      margin-bottom: 30px;
    }

    .template-modern .sub-title {
      color: #d4af37;
    }

    .content {
      font-size: 1.15em;
      line-height: 2;
      color: #2c3e50;
      margin-bottom: 30px;
      text-align: justify;
      font-family: 'Cormorant Garamond', serif;
    }

    .content strong {
      color: #1a237e;
      font-weight: 600;
    }

    .template-modern .content strong {
      color: #d4af37;
    }

    .footer {
      text-align: right;
      color: #d4af37;
      font-size: 1.05em;
      margin-top: 40px;
      font-weight: 500;
      font-style: italic;
      letter-spacing: 0.5px;
    }

    .template-minimalist .footer {
      color: #78909c;
    }

    .qr-code-container {
      text-align: center;
      margin-top: 30px;
      padding-top: 20px;
      border-top: 1px solid #e0e0e0;
    }

    .qr-code-container img {
      width: 120px;
      height: 120px;
      margin-bottom: 10px;
    }

    .qr-code-label {
      font-size: 0.9em;
      color: #78909c;
    }

    .placeholder {
      color: #999;
      font-style: italic;
    }

    .preview-title {
      text-align: center;
      color: #1a237e;
      font-size: 1.6em;
      font-weight: 600;
      margin-bottom: 24px;
    }

    /* Action Buttons */
    .actions-container {
      background: white;
      border-radius: 16px;
      padding: 25px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
      margin-top: 20px;
    }

    .actions-title {
      color: #1a237e;
      font-size: 1.3em;
      font-weight: 600;
      margin-bottom: 20px;
      text-align: center;
    }

    .action-buttons {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
    }

    .btn {
      padding: 12px 20px;
      border: none;
      border-radius: 8px;
      font-size: 0.95em;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      font-family: 'Inter', 'Roboto', sans-serif;
    }

    .btn-primary {
      background: linear-gradient(135deg, #1a237e 0%, #283593 100%);
      color: white;
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(26, 35, 126, 0.3);
    }

    .btn-secondary {
      background: linear-gradient(135deg, #d4af37 0%, #f4d03f 100%);
      color: #1a237e;
    }

    .btn-secondary:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(212, 175, 55, 0.3);
    }

    .btn-success {
      background: #43a047;
      color: white;
    }

    .btn-success:hover {
      background: #388e3c;
      transform: translateY(-2px);
    }

    .btn-info {
      background: #0288d1;
      color: white;
    }

    .btn-info:hover {
      background: #0277bd;
      transform: translateY(-2px);
    }

    @media (max-width: 640px) {
      .action-buttons {
        grid-template-columns: 1fr;
      }
    }

    @media print {
      .form-section,
      .main-title,
      .main-subtitle,
      .preview-title,
      .actions-container,
      .header-bar {
        display: none;
      }

      .grid-container {
        display: block;
      }

      body {
        padding: 0;
        background: white;
      }

      .editor-screen {
        padding: 0;
      }
    }

    /* Guests Manager Screen Styles */
    .guests-screen {
      display: none;
      background: linear-gradient(135deg, #f5f7fa 0%, #e8eaf6 100%);
      min-height: 100vh;
      padding: 30px 0;
    }

    .guests-screen.active {
      display: block;
    }

    .tabs-container {
      display: flex;
      gap: 10px;
      margin-bottom: 30px;
      border-bottom: 2px solid #e0e0e0;
      background: white;
      padding: 0 20px;
      border-radius: 12px 12px 0 0;
      box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    }

    .tab-btn {
      padding: 18px 35px;
      border: none;
      background: transparent;
      color: #5c6bc0;
      font-size: 1.1em;
      font-weight: 600;
      cursor: pointer;
      border-bottom: 3px solid transparent;
      transition: all 0.3s;
      font-family: 'Inter', 'Roboto', sans-serif;
      position: relative;
    }

    .tab-btn:hover {
      background: rgba(92, 107, 192, 0.1);
      transform: translateY(-2px);
    }

    .tab-btn.active {
      color: #1a237e;
      border-bottom-color: #d4af37;
      background: rgba(212, 175, 55, 0.05);
    }

    .tab-btn.active::before {
      content: '';
      position: absolute;
      top: 8px;
      left: 10px;
      width: 6px;
      height: 6px;
      background: #d4af37;
      border-radius: 50%;
    }

    .tab-content {
      display: none;
    }

    .tab-content.active {
      display: block;
      animation: fadeIn 0.3s ease-in;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* Guest Card Layout */
    .guest-card-container {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
      gap: 20px;
      margin-top: 30px;
    }

    .guest-card {
      background: white;
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.08);
      transition: all 0.3s;
      border: 2px solid transparent;
      position: relative;
      overflow: hidden;
    }

    .guest-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 8px 24px rgba(0,0,0,0.12);
      border-color: #d4af37;
    }

    .guest-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, #1a237e, #5c6bc0, #d4af37);
    }

    .guest-card-header {
      display: flex;
      align-items: center;
      gap: 15px;
      margin-bottom: 15px;
    }

    .guest-avatar {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      background: linear-gradient(135deg, #5c6bc0, #7e57c2);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 1.5em;
      font-weight: 600;
      flex-shrink: 0;
      box-shadow: 0 4px 8px rgba(92, 107, 192, 0.3);
    }

    .guest-info {
      flex: 1;
    }

    .guest-name {
      font-size: 1.1em;
      font-weight: 600;
      color: #1a237e;
      margin-bottom: 4px;
    }

    .guest-detail {
      font-size: 0.9em;
      color: #78909c;
      margin-bottom: 2px;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .guest-detail-icon {
      font-size: 0.85em;
    }

    .guest-status-row {
      display: flex;
      gap: 8px;
      margin-top: 15px;
      padding-top: 15px;
      border-top: 1px solid #e0e0e0;
    }

    .guest-actions {
      display: flex;
      gap: 8px;
      margin-top: 12px;
    }

    .guest-action-btn {
      flex: 1;
      padding: 8px 12px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 0.85em;
      font-weight: 600;
      transition: all 0.2s;
    }

    .guest-action-btn.edit {
      background: #5c6bc0;
      color: white;
    }

    .guest-action-btn.edit:hover {
      background: #3f51b5;
    }

    .guest-action-btn.delete {
      background: #ef5350;
      color: white;
    }

    .guest-action-btn.delete:hover {
      background: #d32f2f;
    }

    /* Add icon styles */
    .icon-user::before { content: 'üë§'; }
    .icon-id::before { content: 'üÜî'; }
    .icon-briefcase::before { content: 'üíº'; }
    .icon-email::before { content: 'üìß'; }
    .icon-phone::before { content: 'üìû'; }
    .icon-trophy::before { content: 'üèÜ'; }

    /* Enhanced form section for guest registration */
    .guest-registration-card {
      background: white;
      border-radius: 16px;
      padding: 30px;
      box-shadow: 0 4px 16px rgba(0,0,0,0.1);
      margin-bottom: 30px;
      border-left: 6px solid #d4af37;
    }

    .guest-registration-card h2 {
      color: #1a237e;
      margin-top: 0;
      margin-bottom: 24px;
      display: flex;
      align-items: center;
      gap: 12px;
      font-size: 1.6em;
    }

    .guest-registration-card h2::before {
      content: '‚ú®';
      font-size: 1.2em;
    }

    .form-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
    }

    .form-group-enhanced {
      position: relative;
    }

    .form-group-enhanced label {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 8px;
      color: #1a237e;
      font-weight: 600;
    }

    .form-group-enhanced input,
    .form-group-enhanced select,
    .form-group-enhanced textarea {
      width: 100%;
      padding: 12px 15px;
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      font-size: 1em;
      transition: all 0.3s;
      font-family: 'Inter', 'Roboto', sans-serif;
    }

    .form-group-enhanced input:focus,
    .form-group-enhanced select:focus,
    .form-group-enhanced textarea:focus {
      outline: none;
      border-color: #5c6bc0;
      box-shadow: 0 0 0 3px rgba(92, 107, 192, 0.1);
    }

    .form-group-enhanced textarea {
      min-height: 100px;
      resize: vertical;
    }

    .photo-upload-area {
      border: 2px dashed #d4af37;
      border-radius: 12px;
      padding: 30px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s;
      background: #fffef9;
    }

    .photo-upload-area:hover {
      background: #fff9e6;
      border-color: #c99c2e;
    }

    .photo-upload-icon {
      font-size: 3em;
      margin-bottom: 10px;
    }

    .guests-table-container {
      overflow-x: auto;
      display: none; /* Hide table by default, show cards instead */
    }

    .guests-table {
      width: 100%;
      border-collapse: collapse;
      background: white;
      margin-top: 20px;
    }

    .guests-table th,
    .guests-table td {
      padding: 12px;
      text-align: left;
      border-bottom: 1px solid #e0e0e0;
    }

    .guests-table th {
      background: #1a237e;
      color: white;
      font-weight: 600;
      font-size: 0.9em;
    }

    .guests-table tr:hover {
      background: #f5f7fa;
    }

    /* Toggle view button */
    .view-toggle-btn {
      padding: 10px 20px;
      background: #5c6bc0;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      margin-bottom: 20px;
      transition: all 0.3s;
    }

    .view-toggle-btn:hover {
      background: #3f51b5;
      transform: translateY(-2px);
    }

    .status-badge {
      display: inline-block;
      padding: 4px 12px;
      border-radius: 12px;
      font-size: 0.85em;
      font-weight: 500;
    }

    .status-pending {
      background: #fff3cd;
      color: #856404;
    }

    .status-sent {
      background: #d1ecf1;
      color: #0c5460;
    }

    .status-confirmed {
      background: #d4edda;
      color: #155724;
    }

    .status-not-confirmed {
      background: #f8d7da;
      color: #721c24;
    }

    .action-btn {
      padding: 6px 12px;
      margin: 2px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 0.85em;
      transition: all 0.3s;
    }

    .action-btn.edit {
      background: #5c6bc0;
      color: white;
    }

    .action-btn.delete {
      background: #e57373;
      color: white;
    }

    .action-btn:hover {
      opacity: 0.8;
    }

    .status-select {
      padding: 6px;
      border: 1px solid #e0e0e0;
      border-radius: 4px;
      background: white;
      font-size: 0.85em;
    }

    /* Filters and Statistics Styles */
    .filters-stats-container {
      background: white;
      border-radius: 16px;
      padding: 25px;
      box-shadow: 0 4px 16px rgba(0,0,0,0.1);
      margin-bottom: 30px;
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 15px;
      margin-bottom: 25px;
    }

    .stat-card {
      background: linear-gradient(135deg, #f5f7fa 0%, #e8eaf6 100%);
      border-radius: 12px;
      padding: 20px;
      text-align: center;
      border: 2px solid transparent;
      transition: all 0.3s;
    }

    .stat-card:hover {
      border-color: #5c6bc0;
      transform: translateY(-2px);
    }

    .stat-number {
      font-size: 2em;
      font-weight: 700;
      color: #1a237e;
      margin-bottom: 5px;
    }

    .stat-label {
      font-size: 0.9em;
      color: #78909c;
      font-weight: 500;
    }

    .filters-section {
      border-top: 2px solid #e0e0e0;
      padding-top: 20px;
    }

    .filters-title {
      color: #1a237e;
      font-size: 1.2em;
      font-weight: 600;
      margin-bottom: 15px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .filters-title::before {
      content: 'üîç';
    }

    .filters-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      margin-bottom: 15px;
    }

    .filter-group {
      display: flex;
      flex-direction: column;
      gap: 5px;
    }

    .filter-group label {
      font-size: 0.9em;
      font-weight: 600;
      color: #5c6bc0;
    }

    .filter-group select {
      padding: 10px;
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      font-size: 0.9em;
      transition: all 0.3s;
    }

    .filter-group select:focus {
      outline: none;
      border-color: #5c6bc0;
      box-shadow: 0 0 0 3px rgba(92, 107, 192, 0.1);
    }

    .filter-actions {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }

    .filter-btn {
      padding: 10px 20px;
      border: none;
      border-radius: 8px;
      font-size: 0.9em;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .filter-btn.apply {
      background: #5c6bc0;
      color: white;
    }

    .filter-btn.apply:hover {
      background: #3f51b5;
    }

    .filter-btn.clear {
      background: #e0e0e0;
      color: #5c6bc0;
    }

    .filter-btn.clear:hover {
      background: #bdbdbd;
    }

    .filter-btn.report {
      background: #d4af37;
      color: #1a237e;
    }

    .filter-btn.report:hover {
      background: #c09525;
    }
  </style>
  <!-- Fontes elegantes do Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;500;600;700&family=Playfair+Display:wght@400;500;600;700&family=Inter:wght@400;500;600;700&family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
</head>
<body>
  <!-- Welcome Screen -->
  <div class="welcome-screen" id="welcomeScreen">
    <div class="logo-container">
      <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/b/bf/Coat_of_arms_of_Brazil.svg/800px-Coat_of_arms_of_Brazil.svg.png" alt="Bras√£o da Rep√∫blica" crossorigin="anonymous">
    </div>
    <h1 class="welcome-title">Gerador de Convites CRO/RS</h1>
    <p class="welcome-subtitle">Sistema Profissional de Gera√ß√£o de Convites</p>
    <div class="welcome-description">
      <p>Crie convites personalizados e profissionais para seus eventos do CRO/RS.</p>
      <p>Escolha entre m√∫ltiplos modelos, personalize os detalhes e compartilhe de forma f√°cil.</p>
    </div>
    <div style="display: flex; gap: 20px; justify-content: center; flex-wrap: wrap;">
      <button class="btn-create" onclick="showEditor()">Criar Convite</button>
      <button class="btn-create" onclick="showGuestsManager()">Gerenciar Convidados Especiais</button>
    </div>
  </div>

  <!-- Editor Screen -->
  <div class="editor-screen" id="editorScreen">
    <div class="header-bar">
      <div class="container">
        <div class="brand">
          <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/b/bf/Coat_of_arms_of_Brazil.svg/800px-Coat_of_arms_of_Brazil.svg.png" alt="Bras√£o da Rep√∫blica" crossorigin="anonymous">
          <div class="brand-text">
            <h1>Gerador de Convites</h1>
            <p>CRO/RS</p>
          </div>
        </div>
      </div>
    </div>

    <div class="container">
      <div class="grid-container">
        <!-- Formul√°rio -->
        <div>
          <div class="form-section">
            <h2>Configura√ß√£o do Convite</h2>
            
            <h3 class="section-title">Modelo do Convite</h3>
            <div class="template-selector">
              <label class="template-option active" data-template="formal">
                <input type="radio" name="template" value="formal" checked>
                <div class="template-name">Formal</div>
                <div class="template-description">Elegante e tradicional</div>
              </label>
              <label class="template-option" data-template="modern">
                <input type="radio" name="template" value="modern">
                <div class="template-name">Moderno</div>
                <div class="template-description">Limpo e contempor√¢neo</div>
              </label>
              <label class="template-option" data-template="classic">
                <input type="radio" name="template" value="classic">
                <div class="template-name">Cl√°ssico</div>
                <div class="template-description">Sofisticado e atemporal</div>
              </label>
              <label class="template-option" data-template="minimalist">
                <input type="radio" name="template" value="minimalist">
                <div class="template-name">Minimalista</div>
                <div class="template-description">Simples e direto</div>
              </label>
            </div>

            <h3 class="section-title">Dados do Convite</h3>
            
            <div class="form-group">
              <label for="textoModelo">Modelo de Texto:</label>
              <select id="textoModelo">
                <option value="padrao">Modelo Padr√£o</option>
                <option value="cientifico">Pr√™mio Cient√≠fico ‚Äì CD Ant√¥nio Augusto Pretto</option>
                <option value="politico">Pr√™mio Pol√≠tico ‚Äì CD Jair Soares</option>
                <option value="social">Pr√™mio Social ‚Äì CD Fl√°vio Ant√¥nio Luce</option>
                <option value="autoridades">Modelo para Autoridades</option>
                <option value="remidos">Modelo Remidos</option>
              </select>
            </div>

            <div class="form-group" id="numeroCROGroup" style="display: none;">
              <label for="numeroCRO">N√∫mero do CRO/RS:</label>
              <input type="text" id="numeroCRO" placeholder="Ex: 12345">
              <small style="display: block; margin-top: 5px; color: #78909c; font-size: 0.85em;">
                Este n√∫mero ser√° exibido no convite (ex: "inscrito(a) neste Conselho sob o n¬∫ CRO/RS 12345")
              </small>
            </div>

            <div class="form-group">
              <label for="tipoEvento">Tipo de Evento:</label>
              <select id="tipoEvento">
                <option value="solenidade">Solenidade</option>
                <option value="reuniao">Reuni√£o</option>
                <option value="comemoracao">Comemora√ß√£o</option>
                <option value="outro">Outro</option>
              </select>
            </div>

            <div class="form-group">
              <label for="nomeConvidado">Nome do Convidado:</label>
              <input type="text" id="nomeConvidado" placeholder="Digite o nome do convidado">
            </div>

            <div class="form-group">
              <label for="dataEvento">Data do Evento:</label>
              <input type="text" id="dataEvento" placeholder="Ex: 15 de dezembro de 2024">
            </div>

            <div class="form-group">
              <label for="localEvento">Local do Evento:</label>
              <input type="text" id="localEvento" placeholder="Digite o local do evento">
            </div>

            <div class="form-group">
              <label for="horarioEvento">Hor√°rio:</label>
              <input type="text" id="horarioEvento" placeholder="Ex: 19h00">
            </div>

            <div class="form-group">
              <label for="mensagemPersonalizada">Mensagem Personalizada:</label>
              <textarea id="mensagemPersonalizada" placeholder="Digite uma mensagem especial (opcional)"></textarea>
            </div>

            <h3 class="section-title">Editor de Conte√∫do Avan√ßado</h3>
            <div class="form-group">
              <label>
                <input type="checkbox" id="modoEdicaoAvancada" style="width: auto; margin-right: 8px;">
                Habilitar edi√ß√£o avan√ßada (permite editar todo o conte√∫do do convite com formata√ß√£o rica)
              </label>
              <small style="display: block; margin-top: 5px; color: #78909c; font-size: 0.85em;">
                Quando habilitado, voc√™ poder√° editar todo o texto do convite diretamente no editor abaixo, com negrito, it√°lico, listas e muito mais.
              </small>
            </div>

            <div id="editorAvancadoContainer" style="display: none; margin-top: 15px;">
              <div class="form-group">
                <label>Editor de Texto Enriquecido:</label>
                <div id="editorConteudo" style="background: white; min-height: 300px; border: 1px solid #e0e0e0; border-radius: 8px;"></div>
              </div>
            </div>

            <h3 class="section-title">Op√ß√µes Adicionais</h3>

            <div class="form-group">
              <label for="excelFile">Importar dados do Excel:</label>
              <input type="file" id="excelFile" accept=".xlsx,.xls,.csv,.xlsm,.xlsb" style="padding: 8px; background: white;">
              <small style="display: block; margin-top: 5px; color: #78909c; font-size: 0.85em;">
                <strong>Formatos aceitos:</strong> .xlsx, .xls, .csv, .xlsm, .xlsb (qualquer tipo de Excel)<br>
                <strong>Estrutura esperada:</strong> O arquivo deve conter colunas com nomes como: Nome/Name/Convidado, Data/Date/Dia, Local/Lugar/Location, Hor√°rio/Horario/Hora/Time<br>
                <strong>Como usar:</strong> Selecione o arquivo e os dados da primeira linha ser√£o importados automaticamente para o formul√°rio.
              </small>
            </div>

            <div class="checkbox-group">
              <input type="checkbox" id="incluirQRCode">
              <label for="incluirQRCode">Incluir QR Code para confirma√ß√£o de presen√ßa</label>
            </div>

            <div class="form-group" id="linkConfirmacaoGroup" style="display: none; margin-top: 15px;">
              <label for="linkConfirmacao">Link de Confirma√ß√£o:</label>
              <input type="text" id="linkConfirmacao" placeholder="https://exemplo.com/confirmar">
            </div>
          </div>
        </div>

        <!-- Pr√©via do Convite -->
        <div>
          <h2 class="preview-title">Pr√©via do Convite</h2>
          <div class="convite-container template-formal" id="previewContainer">
            <div class="header">
              <div class="logo-single">
                <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/b/bf/Coat_of_arms_of_Brazil.svg/800px-Coat_of_arms_of_Brazil.svg.png" 
                     alt="Bras√£o da Rep√∫blica" 
                     crossorigin="anonymous"
                     onerror="this.style.display='none'">
              </div>
              <h1 id="previewTitulo">Convite Formal</h1>
              <div class="sub-title">CRO/RS - Conselho Regional de Odontologia do RS</div>
            </div>
            <div class="content" id="previewContent">
              <span>√â com grande honra que convidamos </span>
              <strong><span id="previewNome" class="placeholder">[Nome do Convidado]</span></strong>
              <span> para o evento especial promovido pelo CRO/RS.</span><br>
              <br>
              <span id="previewMensagem"></span>
              <strong>Data:</strong> <span id="previewData" class="placeholder">[Data do evento]</span><br>
              <strong>Local:</strong> <span id="previewLocal" class="placeholder">[Local do evento]</span><br>
              <strong>Hor√°rio:</strong> <span id="previewHorario" class="placeholder">[Hor√°rio]</span><br>
              <br>
              Contamos com sua presen√ßa para abrilhantar ainda mais este momento de celebra√ß√£o da odontologia ga√∫cha.<br>
            </div>
            <div class="footer">
              Atenciosamente,<br>
              CRO/RS
            </div>
            <div class="qr-code-container" id="qrCodeContainer" style="display: none;">
              <img id="qrCodeImage" src="" alt="QR Code">
              <div class="qr-code-label">Escaneie para confirmar presen√ßa</div>
            </div>
          </div>

          <!-- Action Buttons -->
          <div class="actions-container">
            <h3 class="actions-title">A√ß√µes</h3>
            <div class="action-buttons">
              <button class="btn btn-primary" onclick="downloadPDF()">Baixar PDF</button>
              <button class="btn btn-primary" onclick="downloadImage()">Baixar Imagem</button>
              <button class="btn btn-success" onclick="shareWhatsApp()">WhatsApp</button>
              <button class="btn btn-info" onclick="shareEmail()">E-mail</button>
              <button class="btn btn-secondary" onclick="printInvite()">Imprimir</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Guests Manager Screen -->
  <div class="guests-screen" id="guestsScreen">
    <div class="header-bar">
      <div class="container">
        <div class="brand">
          <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/b/bf/Coat_of_arms_of_Brazil.svg/800px-Coat_of_arms_of_Brazil.svg.png" alt="Bras√£o da Rep√∫blica" crossorigin="anonymous">
          <div class="brand-text">
            <h1>Gerenciamento de Convidados Especiais</h1>
            <p>CRO/RS</p>
          </div>
        </div>
        <div style="margin-left: auto; display: flex; gap: 10px;">
          <button class="btn" onclick="deleteAllDatabase()" style="background: #ef5350; color: white;">üóëÔ∏è Excluir Banco de Dados</button>
          <button class="btn btn-secondary" onclick="backToWelcome()">Voltar</button>
        </div>
      </div>
    </div>

    <div class="container">
      <div class="tabs-container">
        <button class="tab-btn active" onclick="showTab('remidos')">Remidos</button>
        <button class="tab-btn" onclick="showTab('autoridades')">Autoridades</button>
        <button class="tab-btn" onclick="showTab('honra')">Honra ao M√©rito</button>
      </div>

      <!-- Tab Content: Remidos -->
      <div id="tab-remidos" class="tab-content active">
        <div class="guest-registration-card">
          <h2>Cadastro de Remidos</h2>
          <div class="form-grid">
            <div class="form-group-enhanced">
              <label><span class="icon-user"></span> Nome Completo:</label>
              <input type="text" id="remidosNome" placeholder="Digite o nome completo">
            </div>
            <div class="form-group-enhanced">
              <label><span class="icon-id"></span> CRO/RS:</label>
              <input type="text" id="remidosCRO" placeholder="Ex: 12345">
            </div>
            <div class="form-group-enhanced">
              <label>üè∑Ô∏è Categoria:</label>
              <select id="remidosCategoria" style="padding: 10px; border: 1px solid #e0e0e0; border-radius: 8px; font-size: 14px;">
                <option value="">Selecione...</option>
                <option value="cientifico">Cient√≠fica</option>
                <option value="politico">Pol√≠tica</option>
                <option value="social">Social</option>
                <option value="outro">Outro</option>
              </select>
            </div>
            <div class="form-group-enhanced">
              <label><span class="icon-email"></span> E-mail:</label>
              <input type="email" id="remidosEmail" placeholder="exemplo@email.com">
            </div>
            <div class="form-group-enhanced">
              <label><span class="icon-phone"></span> Telefone:</label>
              <input type="tel" id="remidosTelefone" placeholder="(51) 99999-9999">
            </div>
            <div class="form-group-enhanced">
              <label>üì± WhatsApp:</label>
              <input type="tel" id="remidosWhatsapp" placeholder="(51) 99999-9999">
            </div>
            <div class="form-group-enhanced">
              <label>üéÇ Data de Nascimento:</label>
              <input type="date" id="remidosNascimento" style="padding: 10px; border: 1px solid #e0e0e0; border-radius: 8px;">
            </div>
            <div class="form-group-enhanced" style="grid-column: 1 / -1;">
              <label>üìç Endere√ßo:</label>
              <input type="text" id="remidosEndereco" placeholder="Rua, n√∫mero, bairro, cidade">
            </div>
          </div>
          <div class="form-grid" style="margin-top: 20px;">
            <div class="form-group-enhanced">
              <label>üìù Biografia (opcional):</label>
              <textarea id="remidosBio" placeholder="Breve biografia do remido"></textarea>
            </div>
            <div class="form-group-enhanced">
              <label>üì∏ Foto (opcional):</label>
              <div class="photo-upload-area" onclick="document.getElementById('remidosFoto').click()">
                <div class="photo-upload-icon">üì∑</div>
                <p>Clique para adicionar foto</p>
                <input type="file" id="remidosFoto" accept="image/*" style="display: none;">
              </div>
            </div>
          </div>
          <button class="btn btn-primary" onclick="addGuest('remidos')" style="margin-top: 20px;">‚ú® Adicionar Remido</button>
          
          <div class="form-grid" style="margin-top: 20px; padding-top: 20px; border-top: 2px solid #e0e0e0;">
            <div class="form-group-enhanced" style="grid-column: 1 / -1;">
              <label>üìä Importar Lista em Excel/CSV:</label>
              <input type="file" id="remidosExcelFile" accept=".xlsx,.xls,.csv" style="padding: 8px; background: white; border: 2px solid #e0e0e0; border-radius: 8px;">
              <small style="display: block; margin-top: 5px; color: #78909c; font-size: 0.85em;">
                <strong>Formatos aceitos:</strong> Excel (.xlsx, .xls) ou CSV (.csv)<br>
                <strong>Estrutura esperada:</strong> O arquivo deve conter colunas: <strong>nome</strong> e <strong>cro</strong> (obrigat√≥rias). Demais campos ser√£o ignorados na importa√ß√£o.<br>
                <strong>Como usar:</strong> Selecione o arquivo e apenas nome e CRO ser√£o importados automaticamente. Outros dados devem ser preenchidos manualmente.<br>
                <a href="#" onclick="downloadTemplate('remidos'); return false;" style="color: #1a237e; font-weight: bold;">‚¨áÔ∏è Baixar modelo de exemplo</a>
              </small>
            </div>
          </div>
        </div>

        <div class="filters-stats-container">
          <div class="stats-grid">
            <div class="stat-card">
              <div class="stat-number" id="remidos-total-count">0</div>
              <div class="stat-label">Total</div>
            </div>
            <div class="stat-card">
              <div class="stat-number" id="remidos-enviado-count">0</div>
              <div class="stat-label">Convites Enviados</div>
            </div>
            <div class="stat-card">
              <div class="stat-number" id="remidos-recebido-count">0</div>
              <div class="stat-label">Recebimentos Confirmados</div>
            </div>
            <div class="stat-card">
              <div class="stat-number" id="remidos-confirmado-count">0</div>
              <div class="stat-label">Presen√ßas Confirmadas</div>
            </div>
          </div>

          <div class="filters-section">
            <div class="filters-title">Filtros Avan√ßados</div>
            <div class="filters-grid">
              <div class="filter-group">
                <label>Convite Enviado:</label>
                <select id="remidos-filter-enviado">
                  <option value="all">Todos</option>
                  <option value="true">Enviado</option>
                  <option value="false">N√£o Enviado</option>
                </select>
              </div>
              <div class="filter-group">
                <label>Recebimento:</label>
                <select id="remidos-filter-recebido">
                  <option value="all">Todos</option>
                  <option value="true">Confirmado</option>
                  <option value="false">N√£o Confirmado</option>
                </select>
              </div>
              <div class="filter-group">
                <label>Presen√ßa:</label>
                <select id="remidos-filter-confirmado">
                  <option value="all">Todos</option>
                  <option value="true">Confirmado</option>
                  <option value="false">N√£o Confirmado</option>
                </select>
              </div>
              <div class="filter-group">
                <label>Tipo de Contato:</label>
                <select id="remidos-filter-contato">
                  <option value="all">Todos</option>
                  <option value="email">Com E-mail</option>
                  <option value="telefone">Com Telefone</option>
                  <option value="whatsapp">Com WhatsApp</option>
                </select>
              </div>
            </div>
            <div class="filter-actions">
              <button class="filter-btn apply" onclick="applyFilters('remidos')">üîç Aplicar Filtros</button>
              <button class="filter-btn clear" onclick="clearFilters('remidos')">‚úñÔ∏è Limpar Filtros</button>
              <button class="filter-btn report" onclick="generateReport('remidos')">üìÑ Gerar Relat√≥rio</button>
            </div>
          </div>
        </div>

        <div style="margin-top: 30px;">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
            <h2 style="margin: 0; color: #1a237e;">Lista de Remidos</h2>
            <button class="view-toggle-btn" onclick="toggleView('remidos')">
              <span id="remidosViewToggle">üìã Ver Tabela</span>
            </button>
          </div>
          
          <div class="guest-card-container" id="remidosCards">
            <!-- Guest cards will be added here dynamically -->
          </div>
          
          <div class="guests-table-container" id="remidosTableContainer">
            <table class="guests-table" id="remidosTable">
              <thead>
                <tr>
                  <th>Nome</th>
                  <th>CRO/RS</th>
                  <th>Categoria</th>
                  <th>E-mail</th>
                  <th>Telefone</th>
                  <th>WhatsApp</th>
                  <th>Nascimento</th>
                  <th>Endere√ßo</th>
                  <th>Convite Enviado</th>
                  <th>Recebimento</th>
                  <th>Presen√ßa</th>
                  <th>Convidados Extras</th>
                  <th>A√ß√µes</th>
                </tr>
              </thead>
              <tbody id="remidosTableBody">
                <!-- Guests will be added here dynamically -->
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- Tab Content: Autoridades -->
      <div id="tab-autoridades" class="tab-content">
        <div class="guest-registration-card">
          <h2>Cadastro de Autoridades</h2>
          <div class="form-grid">
            <div class="form-group-enhanced">
              <label><span class="icon-user"></span> Nome Completo:</label>
              <input type="text" id="autoridadesNome" placeholder="Digite o nome completo">
            </div>
            <div class="form-group-enhanced">
              <label><span class="icon-briefcase"></span> Cargo/Institui√ß√£o:</label>
              <input type="text" id="autoridadesCargo" placeholder="Ex: Prefeito de Porto Alegre">
            </div>
            <div class="form-group-enhanced">
              <label><span class="icon-email"></span> E-mail:</label>
              <input type="email" id="autoridadesEmail" placeholder="exemplo@email.com">
            </div>
            <div class="form-group-enhanced">
              <label><span class="icon-phone"></span> Telefone:</label>
              <input type="tel" id="autoridadesTelefone" placeholder="(51) 99999-9999">
            </div>
            <div class="form-group-enhanced">
              <label>üì± WhatsApp:</label>
              <input type="tel" id="autoridadesWhatsapp" placeholder="(51) 99999-9999">
            </div>
          </div>
          <div class="form-grid" style="margin-top: 20px;">
            <div class="form-group-enhanced">
              <label>üìù Biografia (opcional):</label>
              <textarea id="autoridadesBio" placeholder="Breve biografia da autoridade"></textarea>
            </div>
            <div class="form-group-enhanced">
              <label>üì∏ Foto (opcional):</label>
              <div class="photo-upload-area" onclick="document.getElementById('autoridadesFoto').click()">
                <div class="photo-upload-icon">üì∑</div>
                <p>Clique para adicionar foto</p>
                <input type="file" id="autoridadesFoto" accept="image/*" style="display: none;">
              </div>
            </div>
          </div>
          <button class="btn btn-primary" onclick="addGuest('autoridades')" style="margin-top: 20px;">‚ú® Adicionar Autoridade</button>
          
          <div class="form-grid" style="margin-top: 20px; padding-top: 20px; border-top: 2px solid #e0e0e0;">
            <div class="form-group-enhanced" style="grid-column: 1 / -1;">
              <label>üìä Importar Lista em Excel:</label>
              <input type="file" id="autoridadesExcelFile" accept=".xlsx,.xls" style="padding: 8px; background: white; border: 2px solid #e0e0e0; border-radius: 8px;">
              <small style="display: block; margin-top: 5px; color: #78909c; font-size: 0.85em;">
                <strong>Estrutura esperada:</strong> O arquivo deve conter colunas: Nome, Cargo, Email, Telefone celular (ou Telefone)<br>
                <strong>Como usar:</strong> Selecione o arquivo Excel e os dados ser√£o importados automaticamente.
              </small>
            </div>
          </div>
        </div>

        <div class="filters-stats-container">
          <div class="stats-grid">
            <div class="stat-card">
              <div class="stat-number" id="autoridades-total-count">0</div>
              <div class="stat-label">Total</div>
            </div>
            <div class="stat-card">
              <div class="stat-number" id="autoridades-enviado-count">0</div>
              <div class="stat-label">Convites Enviados</div>
            </div>
            <div class="stat-card">
              <div class="stat-number" id="autoridades-recebido-count">0</div>
              <div class="stat-label">Recebimentos Confirmados</div>
            </div>
            <div class="stat-card">
              <div class="stat-number" id="autoridades-confirmado-count">0</div>
              <div class="stat-label">Presen√ßas Confirmadas</div>
            </div>
          </div>

          <div class="filters-section">
            <div class="filters-title">Filtros Avan√ßados</div>
            <div class="filters-grid">
              <div class="filter-group">
                <label>Convite Enviado:</label>
                <select id="autoridades-filter-enviado">
                  <option value="all">Todos</option>
                  <option value="true">Enviado</option>
                  <option value="false">N√£o Enviado</option>
                </select>
              </div>
              <div class="filter-group">
                <label>Recebimento:</label>
                <select id="autoridades-filter-recebido">
                  <option value="all">Todos</option>
                  <option value="true">Confirmado</option>
                  <option value="false">N√£o Confirmado</option>
                </select>
              </div>
              <div class="filter-group">
                <label>Presen√ßa:</label>
                <select id="autoridades-filter-confirmado">
                  <option value="all">Todos</option>
                  <option value="true">Confirmado</option>
                  <option value="false">N√£o Confirmado</option>
                </select>
              </div>
              <div class="filter-group">
                <label>Tipo de Contato:</label>
                <select id="autoridades-filter-contato">
                  <option value="all">Todos</option>
                  <option value="email">Com E-mail</option>
                  <option value="telefone">Com Telefone</option>
                  <option value="whatsapp">Com WhatsApp</option>
                </select>
              </div>
            </div>
            <div class="filter-actions">
              <button class="filter-btn apply" onclick="applyFilters('autoridades')">üîç Aplicar Filtros</button>
              <button class="filter-btn clear" onclick="clearFilters('autoridades')">‚úñÔ∏è Limpar Filtros</button>
              <button class="filter-btn report" onclick="generateReport('autoridades')">üìÑ Gerar Relat√≥rio</button>
            </div>
          </div>
        </div>

        <div style="margin-top: 30px;">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
            <h2 style="margin: 0; color: #1a237e;">Lista de Autoridades</h2>
            <button class="view-toggle-btn" onclick="toggleView('autoridades')">
              <span id="autoridadesViewToggle">üìã Ver Tabela</span>
            </button>
          </div>
          
          <div class="guest-card-container" id="autoridadesCards">
            <!-- Guest cards will be added here dynamically -->
          </div>
          
          <div class="guests-table-container" id="autoridadesTableContainer">
            <table class="guests-table" id="autoridadesTable">
              <thead>
                <tr>
                  <th>Nome</th>
                  <th>Cargo/Institui√ß√£o</th>
                  <th>E-mail</th>
                  <th>Telefone</th>
                  <th>WhatsApp</th>
                  <th>Convite Enviado</th>
                  <th>Recebimento</th>
                  <th>Presen√ßa</th>
                  <th>Convidados Extras</th>
                  <th>A√ß√µes</th>
                </tr>
              </thead>
              <tbody id="autoridadesTableBody">
                <!-- Guests will be added here dynamically -->
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- Tab Content: Honra ao M√©rito -->
      <div id="tab-honra" class="tab-content">
        <div class="guest-registration-card">
          <h2>Cadastro de Honra ao M√©rito</h2>
          <div class="form-grid">
            <div class="form-group-enhanced">
              <label><span class="icon-user"></span> Nome Completo:</label>
              <input type="text" id="honraNome" placeholder="Digite o nome completo">
            </div>
            <div class="form-group-enhanced">
              <label><span class="icon-trophy"></span> Categoria:</label>
              <select id="honraCategoria">
                <option value="cientifico">Cient√≠fica - CD Ant√¥nio Augusto Pretto</option>
                <option value="politico">Pol√≠tica - CD Jair Soares</option>
                <option value="social">Social - CD Fl√°vio Ant√¥nio Luce</option>
              </select>
            </div>
            <div class="form-group-enhanced">
              <label><span class="icon-email"></span> E-mail:</label>
              <input type="email" id="honraEmail" placeholder="exemplo@email.com">
            </div>
            <div class="form-group-enhanced">
              <label><span class="icon-phone"></span> Telefone:</label>
              <input type="tel" id="honraTelefone" placeholder="(51) 99999-9999">
            </div>
            <div class="form-group-enhanced">
              <label>üì± WhatsApp:</label>
              <input type="tel" id="honraWhatsapp" placeholder="(51) 99999-9999">
            </div>
          </div>
          <div class="form-grid" style="margin-top: 20px;">
            <div class="form-group-enhanced">
              <label>üìù Biografia (opcional):</label>
              <textarea id="honraBio" placeholder="Breve biografia do homenageado"></textarea>
            </div>
            <div class="form-group-enhanced">
              <label>üì∏ Foto (opcional):</label>
              <div class="photo-upload-area" onclick="document.getElementById('honraFoto').click()">
                <div class="photo-upload-icon">üì∑</div>
                <p>Clique para adicionar foto</p>
                <input type="file" id="honraFoto" accept="image/*" style="display: none;">
              </div>
            </div>
          </div>
          <button class="btn btn-primary" onclick="addGuest('honra')" style="margin-top: 20px;">‚ú® Adicionar Homenageado</button>
          
          <div class="form-grid" style="margin-top: 20px; padding-top: 20px; border-top: 2px solid #e0e0e0;">
            <div class="form-group-enhanced" style="grid-column: 1 / -1;">
              <label>üìä Importar Lista em Excel:</label>
              <input type="file" id="honraExcelFile" accept=".xlsx,.xls" style="padding: 8px; background: white; border: 2px solid #e0e0e0; border-radius: 8px;">
              <small style="display: block; margin-top: 5px; color: #78909c; font-size: 0.85em;">
                <strong>Estrutura esperada:</strong> O arquivo deve conter colunas: Nome, Categoria, Email, Telefone celular (ou Telefone)<br>
                <strong>Como usar:</strong> Selecione o arquivo Excel e os dados ser√£o importados automaticamente. A categoria pode ser: Cient√≠fica, Pol√≠tica ou Social.
              </small>
            </div>
          </div>
        </div>

        <div class="filters-stats-container">
          <div class="stats-grid">
            <div class="stat-card">
              <div class="stat-number" id="honra-total-count">0</div>
              <div class="stat-label">Total</div>
            </div>
            <div class="stat-card">
              <div class="stat-number" id="honra-enviado-count">0</div>
              <div class="stat-label">Convites Enviados</div>
            </div>
            <div class="stat-card">
              <div class="stat-number" id="honra-recebido-count">0</div>
              <div class="stat-label">Recebimentos Confirmados</div>
            </div>
            <div class="stat-card">
              <div class="stat-number" id="honra-confirmado-count">0</div>
              <div class="stat-label">Presen√ßas Confirmadas</div>
            </div>
          </div>

          <div class="filters-section">
            <div class="filters-title">Filtros Avan√ßados</div>
            <div class="filters-grid">
              <div class="filter-group">
                <label>Convite Enviado:</label>
                <select id="honra-filter-enviado">
                  <option value="all">Todos</option>
                  <option value="true">Enviado</option>
                  <option value="false">N√£o Enviado</option>
                </select>
              </div>
              <div class="filter-group">
                <label>Recebimento:</label>
                <select id="honra-filter-recebido">
                  <option value="all">Todos</option>
                  <option value="true">Confirmado</option>
                  <option value="false">N√£o Confirmado</option>
                </select>
              </div>
              <div class="filter-group">
                <label>Presen√ßa:</label>
                <select id="honra-filter-confirmado">
                  <option value="all">Todos</option>
                  <option value="true">Confirmado</option>
                  <option value="false">N√£o Confirmado</option>
                </select>
              </div>
              <div class="filter-group">
                <label>Tipo de Contato:</label>
                <select id="honra-filter-contato">
                  <option value="all">Todos</option>
                  <option value="email">Com E-mail</option>
                  <option value="telefone">Com Telefone</option>
                  <option value="whatsapp">Com WhatsApp</option>
                </select>
              </div>
            </div>
            <div class="filter-actions">
              <button class="filter-btn apply" onclick="applyFilters('honra')">üîç Aplicar Filtros</button>
              <button class="filter-btn clear" onclick="clearFilters('honra')">‚úñÔ∏è Limpar Filtros</button>
              <button class="filter-btn report" onclick="generateReport('honra')">üìÑ Gerar Relat√≥rio</button>
            </div>
          </div>
        </div>

        <div style="margin-top: 30px;">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
            <h2 style="margin: 0; color: #1a237e;">Lista de Honra ao M√©rito</h2>
            <button class="view-toggle-btn" onclick="toggleView('honra')">
              <span id="honraViewToggle">üìã Ver Tabela</span>
            </button>
          </div>
          
          <div class="guest-card-container" id="honraCards">
            <!-- Guest cards will be added here dynamically -->
          </div>
          
          <div class="guests-table-container" id="honraTableContainer">
            <table class="guests-table" id="honraTable">
              <thead>
                <tr>
                  <th>Nome</th>
                  <th>Categoria</th>
                  <th>E-mail</th>
                  <th>Telefone</th>
                  <th>WhatsApp</th>
                  <th>Convite Enviado</th>
                  <th>Recebimento</th>
                  <th>Presen√ßa</th>
                  <th>Convidados Extras</th>
                  <th>A√ß√µes</th>
                </tr>
              </thead>
              <tbody id="honraTableBody">
                <!-- Guests will be added here dynamically -->
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Quill.js for Rich Text Editor -->
  <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
  <script src="https://cdn.quilljs.com/1.3.6/quill.min.js"></script>
  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script>
    // Show/Hide screens
    function showEditor() {
      document.getElementById('welcomeScreen').classList.add('hidden');
      document.getElementById('editorScreen').classList.add('active');
      document.getElementById('guestsScreen').classList.remove('active');
    }

    function showGuestsManager() {
      document.getElementById('welcomeScreen').classList.add('hidden');
      document.getElementById('editorScreen').classList.remove('active');
      document.getElementById('guestsScreen').classList.add('active');
      loadGuests();
    }

    function backToWelcome() {
      document.getElementById('welcomeScreen').classList.remove('hidden');
      document.getElementById('editorScreen').classList.remove('active');
      document.getElementById('guestsScreen').classList.remove('active');
    }

    // Elementos do formul√°rio
    const nomeConvidadoInput = document.getElementById('nomeConvidado');
    const dataEventoInput = document.getElementById('dataEvento');
    const localEventoInput = document.getElementById('localEvento');
    const horarioEventoInput = document.getElementById('horarioEvento');
    const mensagemPersonalizadaInput = document.getElementById('mensagemPersonalizada');
    const tipoEventoSelect = document.getElementById('tipoEvento');
    const textoModeloSelect = document.getElementById('textoModelo');
    const numeroCROInput = document.getElementById('numeroCRO');
    const numeroCROGroup = document.getElementById('numeroCROGroup');
    const excelFileInput = document.getElementById('excelFile');
    const incluirQRCodeCheckbox = document.getElementById('incluirQRCode');
    const linkConfirmacaoInput = document.getElementById('linkConfirmacao');

    // Elementos de pr√©via
    const previewNome = document.getElementById('previewNome');
    const previewData = document.getElementById('previewData');
    const previewLocal = document.getElementById('previewLocal');
    const previewHorario = document.getElementById('previewHorario');
    const previewMensagem = document.getElementById('previewMensagem');
    const previewTitulo = document.getElementById('previewTitulo');
    const previewContent = document.getElementById('previewContent');
    const previewContainer = document.getElementById('previewContainer');
    const qrCodeContainer = document.getElementById('qrCodeContainer');

    // Rich Text Editor (Quill)
    let quillEditor = null;
    let modoEdicaoAvancadaAtivo = false;
    const modoEdicaoAvancadaCheckbox = document.getElementById('modoEdicaoAvancada');
    const editorAvancadoContainer = document.getElementById('editorAvancadoContainer');

    // Initialize Quill editor
    function initQuillEditor() {
      if (!quillEditor) {
        quillEditor = new Quill('#editorConteudo', {
          theme: 'snow',
          modules: {
            toolbar: [
              [{ 'header': [1, 2, 3, false] }],
              ['bold', 'italic', 'underline'],
              [{ 'list': 'ordered'}, { 'list': 'bullet' }],
              [{ 'align': [] }],
              ['clean']
            ]
          },
          placeholder: 'Digite o conte√∫do completo do convite aqui...'
        });
        
        // Update preview when editor content changes
        quillEditor.on('text-change', function() {
          if (modoEdicaoAvancadaAtivo) {
            atualizarPrevia();
          }
        });
      }
    }

    // Toggle advanced editing mode
    modoEdicaoAvancadaCheckbox.addEventListener('change', function() {
      modoEdicaoAvancadaAtivo = this.checked;
      
      if (modoEdicaoAvancadaAtivo) {
        // Show editor
        editorAvancadoContainer.style.display = 'block';
        
        // Initialize editor if not already done
        initQuillEditor();
        
        // Load current preview content into editor
        const currentContent = previewContent.innerHTML;
        quillEditor.root.innerHTML = currentContent;
        
        // Disable individual form fields
        nomeConvidadoInput.disabled = true;
        dataEventoInput.disabled = true;
        localEventoInput.disabled = true;
        horarioEventoInput.disabled = true;
        mensagemPersonalizadaInput.disabled = true;
        textoModeloSelect.disabled = true;
      } else {
        // Hide editor
        editorAvancadoContainer.style.display = 'none';
        
        // Enable individual form fields
        nomeConvidadoInput.disabled = false;
        dataEventoInput.disabled = false;
        localEventoInput.disabled = false;
        horarioEventoInput.disabled = false;
        mensagemPersonalizadaInput.disabled = false;
        textoModeloSelect.disabled = false;
        
        // Update preview from form fields
        atualizarPrevia();
      }
    });

    // Modelos de texto para convites
    const textosModelos = {
      padrao: {
        titulo: 'Convite',
        conteudo: (nome, data, local, horario, mensagem) => `
          <span>√â com grande honra que convidamos </span>
          <strong><span class="${nome ? '' : 'placeholder'}">${nome || '[Nome do Convidado]'}</span></strong>
          <span> para o evento especial promovido pelo CRO/RS.</span><br>
          <br>
          ${mensagem ? mensagem + '<br><br>' : ''}
          <strong>Data:</strong> <span class="${data ? '' : 'placeholder'}">${data || '[Data do evento]'}</span><br>
          <strong>Local:</strong> <span class="${local ? '' : 'placeholder'}">${local || '[Local do evento]'}</span><br>
          <strong>Hor√°rio:</strong> <span class="${horario ? '' : 'placeholder'}">${horario || '[Hor√°rio]'}</span><br>
          <br>
          Contamos com sua presen√ßa para abrilhantar ainda mais este momento de celebra√ß√£o da odontologia ga√∫cha.<br>
        `
      },
      cientifico: {
        titulo: 'PR√äMIO CIENT√çFICO ‚Äì CD ANT√îNIO AUGUSTO PRETTO',
        conteudo: (nome, data, local, horario, mensagem) => `
          <span>O Conselho Regional de Odontologia do Estado do Rio Grande do Sul, por meio de seu Presidente, CD Nelson Freitas Eguia, tem a honra de convidar o(a) </span>
          <strong><span class="${nome ? '' : 'placeholder'}">${nome || '[NOME COMPLETO]'}</span></strong>
          <span> para receber o Trof√©u Honra ao M√©rito da Odontologia Ga√∫cha ‚Äì Categoria Cient√≠fica "CD Ant√¥nio Augusto Pretto", em reconhecimento √†s relevantes contribui√ß√µes no campo da pesquisa, extens√£o, ensino e servi√ßos √† Odontologia.</span><br>
          <br>
          ${mensagem ? mensagem + '<br><br>' : ''}
          A cerim√¥nia de entrega ocorrer√° durante o Evento Alusivo ao Dia do Cirurgi√£o-Dentista ‚Äì Edi√ß√£o 2025, conforme segue:<br>
          <br>
          <strong>Data:</strong> <span class="${data ? '' : 'placeholder'}">${data || '31 de outubro de 2025'}</span><br>
          <strong>Hor√°rio:</strong> <span class="${horario ? '' : 'placeholder'}">${horario || '19h'}</span><br>
          <strong>Local:</strong> <span class="${local ? '' : 'placeholder'}">${local || 'Sede do CRO/RS ‚Äì Rua Vasco da Gama, n¬∫ 720, Bairro Bom Fim, Porto Alegre/RS'}</span><br>
          <br>
          Vossa Senhoria poder√° comparecer acompanhada de at√© dois convidados.<br>
          <br>
          Solicitamos a confirma√ß√£o de presen√ßa at√© o dia 15 de outubro de 2025, pelos canais abaixo:<br>
          <br>
          <strong>Telefone:</strong> (51) 3026-1716 ‚Äì falar com Carlos ou Bianca<br>
          <strong>E-mail:</strong> secretaria@crors.org.br<br>
        `
      },
      politico: {
        titulo: 'PR√äMIO POL√çTICO ‚Äì CD JAIR SOARES',
        conteudo: (nome, data, local, horario, mensagem) => `
          <span>O Conselho Regional de Odontologia do Estado do Rio Grande do Sul, por meio de seu Presidente, CD Nelson Freitas Eguia, tem a honra de convidar o(a) </span>
          <strong><span class="${nome ? '' : 'placeholder'}">${nome || '[NOME COMPLETO]'}</span></strong>
          <span> para receber o Trof√©u Honra ao M√©rito da Odontologia Ga√∫cha ‚Äì Categoria Pol√≠tica "CD Jair Soares", em reconhecimento √† destacada atua√ß√£o pol√≠tica e comunit√°ria em benef√≠cio da profiss√£o odontol√≥gica e da ci√™ncia.</span><br>
          <br>
          ${mensagem ? mensagem + '<br><br>' : ''}
          A cerim√¥nia de entrega ocorrer√° durante o Evento Alusivo ao Dia do Cirurgi√£o-Dentista ‚Äì Edi√ß√£o 2025, conforme segue:<br>
          <br>
          <strong>Data:</strong> <span class="${data ? '' : 'placeholder'}">${data || '31 de outubro de 2025'}</span><br>
          <strong>Hor√°rio:</strong> <span class="${horario ? '' : 'placeholder'}">${horario || '19h'}</span><br>
          <strong>Local:</strong> <span class="${local ? '' : 'placeholder'}">${local || 'Sede do CRO/RS ‚Äì Rua Vasco da Gama, n¬∫ 720, Bairro Bom Fim, Porto Alegre/RS'}</span><br>
          <br>
          Vossa Senhoria poder√° comparecer acompanhada de at√© dois convidados.<br>
          <br>
          Solicitamos a confirma√ß√£o de presen√ßa at√© o dia 15 de outubro de 2025, pelos canais abaixo:<br>
          <br>
          <strong>Telefone:</strong> (51) 3026-1716 ‚Äì falar com Carlos ou Bianca<br>
          <strong>E-mail:</strong> secretaria@crors.org.br<br>
        `
      },
      social: {
        titulo: 'PR√äMIO SOCIAL ‚Äì CD FL√ÅVIO ANT√îNIO LUCE',
        conteudo: (nome, data, local, horario, mensagem) => `
          <span>O Conselho Regional de Odontologia do Estado do Rio Grande do Sul, por meio de seu Presidente, CD Nelson Freitas Eguia, tem a honra de convidar o(a) </span>
          <strong><span class="${nome ? '' : 'placeholder'}">${nome || '[NOME COMPLETO]'}</span></strong>
          <span> para receber o Trof√©u Honra ao M√©rito da Odontologia Ga√∫cha ‚Äì Categoria Social "CD Fl√°vio Ant√¥nio Luce", em reconhecimento √†s relevantes contribui√ß√µes na presta√ß√£o de servi√ßos sociais e na participa√ß√£o associativa em entidades da classe odontol√≥gica.</span><br>
          <br>
          ${mensagem ? mensagem + '<br><br>' : ''}
          A cerim√¥nia de entrega ocorrer√° durante o Evento Alusivo ao Dia do Cirurgi√£o-Dentista ‚Äì Edi√ß√£o 2025, conforme segue:<br>
          <br>
          <strong>Data:</strong> <span class="${data ? '' : 'placeholder'}">${data || '31 de outubro de 2025'}</span><br>
          <strong>Hor√°rio:</strong> <span class="${horario ? '' : 'placeholder'}">${horario || '19h'}</span><br>
          <strong>Local:</strong> <span class="${local ? '' : 'placeholder'}">${local || 'Sede do CRO/RS ‚Äì Rua Vasco da Gama, n¬∫ 720, Bairro Bom Fim, Porto Alegre/RS'}</span><br>
          <br>
          Vossa Senhoria poder√° comparecer acompanhada de at√© dois convidados.<br>
          <br>
          Solicitamos a confirma√ß√£o de presen√ßa at√© o dia 15 de outubro de 2025, pelos canais abaixo:<br>
          <br>
          <strong>Telefone:</strong> (51) 3026-1716 ‚Äì falar com Carlos ou Bianca<br>
          <strong>E-mail:</strong> secretaria@crors.org.br<br>
        `
      },
      autoridades: {
        titulo: 'CONVITE REMIDOS 2025 E HONRA AO M√âRITO DA ODONTOLOGIA GA√öCHA',
        conteudo: (nome, data, local, horario, mensagem) => `
          <span>O Conselho Regional de Odontologia do Estado do Rio Grande do Sul, por meio de seu Presidente, CD Nelson Freitas Eguia, tem a honra de convidar Vossa Excel√™ncia </span>
          <strong><span class="${nome ? '' : 'placeholder'}">${nome || '[Nome da Autoridade]'}</span></strong>
          <span> para participar do Evento Alusivo ao Dia do Cirurgi√£o-Dentista ‚Äì Edi√ß√£o 2025, a realizar-se conforme segue:</span><br>
          <br>
          ${mensagem ? mensagem + '<br><br>' : ''}
          <strong>Data:</strong> <span class="${data ? '' : 'placeholder'}">${data || '31 de outubro de 2025'}</span><br>
          <strong>Hor√°rio:</strong> <span class="${horario ? '' : 'placeholder'}">${horario || '19h'}</span><br>
          <strong>Local:</strong> <span class="${local ? '' : 'placeholder'}">${local || 'Sede do CRO/RS ‚Äì Rua Vasco da Gama, n¬∫ 720, Bairro Bom Fim, Porto Alegre/RS'}</span><br>
          <br>
          O evento ser√° marcado por solenidade, reconhecimento e celebra√ß√£o da Odontologia ga√∫cha, reunindo profissionais, representantes de institui√ß√µes e autoridades, al√©m da entrega do Trof√©u Honra ao M√©rito da Odontologia Ga√∫cha, nas categorias Cient√≠fica, Pol√≠tica e Social.<br>
          <br>
          Solicitamos a confirma√ß√£o de presen√ßa at√© o dia 15 de outubro de 2025, pelos canais abaixo:<br>
          <br>
          <strong>Telefone:</strong> (51) 3026-1716 ‚Äì falar com Carlos ou Bianca<br>
          <strong>E-mail:</strong> secretaria@crors.org.br<br>
          <br>
          Cientes da relev√¢ncia de sua participa√ß√£o, renovamos votos de elevada estima e distinta considera√ß√£o.<br>
        `
      },
      remidos: {
        titulo: 'CONVITE REMIDOS 2025',
        conteudo: (nome, data, local, horario, mensagem, numeroCRO) => `
          <span>O Conselho Regional de Odontologia do Estado do Rio Grande do Sul, por meio de seu Presidente, CD Nelson Freitas Eguia, tem a honra de convidar o(a) Cirurgi√£o(√£)-Dentista </span>
          <strong><span class="${nome ? '' : 'placeholder'}">${nome || '[NOME COMPLETO]'}</span></strong>
          <span>, inscrito(a) neste Conselho sob o n¬∫ CRO/RS <strong><span class="${numeroCRO ? '' : 'placeholder'}">${numeroCRO || '[XXXXX]'}</span></strong>, para participar do Evento Alusivo ao Dia do Cirurgi√£o-Dentista ‚Äì Edi√ß√£o 2025, ocasi√£o em que lhe ser√° outorgada a condi√ß√£o de Remido(a) deste Regional.</span><br>
          <br>
          ${mensagem ? mensagem + '<br><br>' : ''}
          <strong>Data:</strong> <span class="${data ? '' : 'placeholder'}">${data || '31 de outubro de 2025'}</span><br>
          <strong>Hor√°rio:</strong> <span class="${horario ? '' : 'placeholder'}">${horario || '18h'}</span><br>
          <strong>Local:</strong> <span class="${local ? '' : 'placeholder'}">${local || 'Sede do CRO/RS ‚Äì Rua Vasco da Gama, n¬∫ 720, Bairro Bom Fim, Porto Alegre/RS'}</span><br>
          <br>
          Trata-se de um momento especial de reconhecimento e valoriza√ß√£o, ao qual Vossa Senhoria poder√° comparecer acompanhado(a) de uma pessoa de sua escolha.<br>
          <br>
          Solicitamos a confirma√ß√£o de presen√ßa at√© o dia 15 de outubro de 2025, pelos canais abaixo:<br>
          <br>
          <strong>Telefone:</strong> (51) 3026-1716 ‚Äì falar com Carlos ou Bianca<br>
          <strong>E-mail:</strong> secretaria@crors.org.br<br>
          <br>
          Certos de podermos contar com sua honrosa presen√ßa, renovamos votos de elevada estima e distinta considera√ß√£o.<br>
        `
      }
    };

    // Template selection
    const templateOptions = document.querySelectorAll('.template-option');
    const templateRadios = document.querySelectorAll('input[name="template"]');

    templateOptions.forEach(option => {
      option.addEventListener('click', function() {
        templateOptions.forEach(opt => opt.classList.remove('active'));
        this.classList.add('active');
        this.querySelector('input[type="radio"]').checked = true;
        updateTemplate();
      });
    });

    function updateTemplate() {
      const selectedTemplate = document.querySelector('input[name="template"]:checked').value;
      previewContainer.className = 'convite-container template-' + selectedTemplate;
      
      // Update title based on template
      const titles = {
        'formal': 'Convite Formal',
        'modern': 'Convite',
        'classic': 'Convite Especial',
        'minimalist': 'Convite'
      };
      previewTitulo.textContent = titles[selectedTemplate] || 'Convite';
    }

    // Fun√ß√£o para atualizar a pr√©via
    function atualizarPrevia() {
      // If advanced editing mode is active, use Quill editor content
      if (modoEdicaoAvancadaAtivo && quillEditor) {
        previewContent.innerHTML = quillEditor.root.innerHTML;
        return;
      }

      // Normal mode: use form fields
      const nome = nomeConvidadoInput.value.trim();
      const data = dataEventoInput.value.trim();
      const local = localEventoInput.value.trim();
      const horario = horarioEventoInput.value.trim();
      const mensagem = mensagemPersonalizadaInput.value.trim();
      const modeloTexto = textoModeloSelect.value;
      const numeroCRO = numeroCROInput.value.trim();

      // Show/hide CRO field based on selected model
      if (modeloTexto === 'remidos') {
        numeroCROGroup.style.display = 'block';
      } else {
        numeroCROGroup.style.display = 'none';
      }

      // Atualizar t√≠tulo baseado no modelo de texto
      const modelo = textosModelos[modeloTexto];
      previewTitulo.textContent = modelo.titulo;

      // Atualizar conte√∫do usando o modelo de texto
      // Pass numeroCRO as the 6th parameter for remidos template
      if (modeloTexto === 'remidos') {
        previewContent.innerHTML = modelo.conteudo(nome, data, local, horario, mensagem, numeroCRO);
      } else {
        previewContent.innerHTML = modelo.conteudo(nome, data, local, horario, mensagem);
      }
    }

    // Excel Import Functionality
    excelFileInput.addEventListener('change', function(e) {
      const file = e.target.files[0];
      if (!file) return;

      const reader = new FileReader();
      reader.onload = function(e) {
        try {
          const data = new Uint8Array(e.target.result);
          const workbook = XLSX.read(data, { type: 'array' });
          
          // Get first sheet
          const firstSheetName = workbook.SheetNames[0];
          const worksheet = workbook.Sheets[firstSheetName];
          
          // Convert to JSON
          const jsonData = XLSX.utils.sheet_to_json(worksheet);
          
          if (jsonData.length > 0) {
            const firstRow = jsonData[0];
            
            // Try to find columns with common names (case insensitive)
            const findColumn = (row, possibleNames) => {
              for (let key in row) {
                if (possibleNames.some(name => key.toLowerCase().includes(name.toLowerCase()))) {
                  return row[key];
                }
              }
              return '';
            };
            
            // Auto-fill form fields
            const nome = findColumn(firstRow, ['nome', 'name', 'convidado']);
            const data = findColumn(firstRow, ['data', 'date', 'dia']);
            const local = findColumn(firstRow, ['local', 'lugar', 'location', 'endere√ßo', 'endereco']);
            const horario = findColumn(firstRow, ['hor√°rio', 'horario', 'hora', 'time']);
            
            if (nome) nomeConvidadoInput.value = nome;
            if (data) dataEventoInput.value = data;
            if (local) localEventoInput.value = local;
            if (horario) horarioEventoInput.value = horario;
            
            // Update preview
            atualizarPrevia();
            
            alert('Dados importados com sucesso! Primeira linha do arquivo foi carregada.');
          } else {
            alert('O arquivo Excel est√° vazio.');
          }
        } catch (error) {
          console.error('Erro ao processar arquivo:', error);
          alert('Erro ao processar arquivo Excel. Verifique se o formato est√° correto.');
        }
      };
      
      reader.readAsArrayBuffer(file);
    });

    // QR Code functionality
    incluirQRCodeCheckbox.addEventListener('change', function() {
      const linkGroup = document.getElementById('linkConfirmacaoGroup');
      if (this.checked) {
        linkGroup.style.display = 'block';
      } else {
        linkGroup.style.display = 'none';
        qrCodeContainer.style.display = 'none';
      }
    });

    linkConfirmacaoInput.addEventListener('input', function() {
      if (incluirQRCodeCheckbox.checked && this.value.trim()) {
        generateQRCode(this.value);
        qrCodeContainer.style.display = 'block';
      } else {
        qrCodeContainer.style.display = 'none';
      }
    });

    let qrCode = null;
    function generateQRCode(url) {
      const qrElement = document.getElementById('qrCodeImage');
      
      // Clear previous QR code
      if (qrCode) {
        qrElement.parentElement.querySelector('#qrcode-temp')?.remove();
      }
      
      // Create temporary container
      const tempDiv = document.createElement('div');
      tempDiv.id = 'qrcode-temp';
      tempDiv.style.display = 'none';
      document.body.appendChild(tempDiv);
      
      // Generate QR code
      qrCode = new QRCode(tempDiv, {
        text: url,
        width: 120,
        height: 120
      });
      
      // Wait for QR code to be generated and then get the image
      setTimeout(() => {
        const img = tempDiv.querySelector('img');
        if (img) {
          qrElement.src = img.src;
        }
      }, 100);
    }

    // Action functions
    function downloadPDF() {
      const { jsPDF } = window.jspdf;
      
      html2canvas(previewContainer, {
        scale: 2,
        useCORS: true,
        logging: false
      }).then(canvas => {
        const imgData = canvas.toDataURL('image/png');
        const pdf = new jsPDF({
          orientation: 'portrait',
          unit: 'mm',
          format: 'a4'
        });
        
        const imgWidth = 190;
        const imgHeight = (canvas.height * imgWidth) / canvas.width;
        const x = 10;
        const y = 10;
        
        pdf.addImage(imgData, 'PNG', x, y, imgWidth, imgHeight);
        pdf.save('convite-cro-rs.pdf');
      });
    }

    function downloadImage() {
      html2canvas(previewContainer, {
        scale: 2,
        useCORS: true,
        logging: false
      }).then(canvas => {
        const link = document.createElement('a');
        link.download = 'convite-cro-rs.png';
        link.href = canvas.toDataURL('image/png');
        link.click();
      });
    }

    function shareWhatsApp() {
      const nome = nomeConvidadoInput.value || '[Nome]';
      const data = dataEventoInput.value || '[Data]';
      const local = localEventoInput.value || '[Local]';
      const horario = horarioEventoInput.value || '[Hor√°rio]';
      const tipoEvento = tipoEventoSelect.options[tipoEventoSelect.selectedIndex].text;
      
      const mensagem = `Convite Especial - CRO/RS%0A%0A` +
                      `Convidado: ${nome}%0A` +
                      `Tipo de Evento: ${tipoEvento}%0A` +
                      `Data: ${data}%0A` +
                      `Local: ${local}%0A` +
                      `Hor√°rio: ${horario}%0A%0A` +
                      `Contamos com sua presen√ßa!`;
      
      window.open(`https://wa.me/?text=${mensagem}`, '_blank');
    }

    function shareEmail() {
      const nome = nomeConvidadoInput.value || '[Nome]';
      const data = dataEventoInput.value || '[Data]';
      const local = localEventoInput.value || '[Local]';
      const horario = horarioEventoInput.value || '[Hor√°rio]';
      const tipoEvento = tipoEventoSelect.options[tipoEventoSelect.selectedIndex].text;
      
      const assunto = `Convite: ${tipoEvento} - CRO/RS`;
      const corpo = `Prezado(a) ${nome},%0A%0A` +
                   `√â com grande honra que convidamos V.Sa. para o evento especial promovido pelo CRO/RS.%0A%0A` +
                   `Tipo de Evento: ${tipoEvento}%0A` +
                   `Data: ${data}%0A` +
                   `Local: ${local}%0A` +
                   `Hor√°rio: ${horario}%0A%0A` +
                   `Contamos com sua presen√ßa para abrilhantar ainda mais este momento de celebra√ß√£o da odontologia ga√∫cha.%0A%0A` +
                   `Atenciosamente,%0ACRO/RS`;
      
      window.location.href = `mailto:?subject=${assunto}&body=${corpo}`;
    }

    function printInvite() {
      window.print();
    }

    // Adicionar event listeners para atualiza√ß√£o em tempo real
    nomeConvidadoInput.addEventListener('input', atualizarPrevia);
    dataEventoInput.addEventListener('input', atualizarPrevia);
    localEventoInput.addEventListener('input', atualizarPrevia);
    horarioEventoInput.addEventListener('input', atualizarPrevia);
    mensagemPersonalizadaInput.addEventListener('input', atualizarPrevia);
    tipoEventoSelect.addEventListener('change', atualizarPrevia);
    textoModeloSelect.addEventListener('change', atualizarPrevia);
    numeroCROInput.addEventListener('input', atualizarPrevia);

    // Inicializar pr√©via
    atualizarPrevia();

    // Guests Management System
    let guestsData = {
      remidos: [],
      autoridades: [],
      honra: []
    };

    // Load guests from localStorage
    function loadGuests() {
      const stored = localStorage.getItem('cro_guests_data');
      if (stored) {
        guestsData = JSON.parse(stored);
      }
      renderAllTables();
    }

    // Save guests to localStorage
    function saveGuests() {
      localStorage.setItem('cro_guests_data', JSON.stringify(guestsData));
    }

    // Delete all database with password protection
    function deleteAllDatabase() {
      const password = prompt('‚ö†Ô∏è ATEN√á√ÉO: Esta a√ß√£o ir√° excluir todos os dados de convidados!\n\nPara confirmar, digite a senha:');
      
      if (password === null) {
        // User cancelled
        return;
      }
      
      if (password === 'odonto@@2025') {
        if (confirm('Tem certeza que deseja excluir todos os dados? Esta a√ß√£o n√£o pode ser desfeita!')) {
          // Clear all guest data
          guestsData = {
            remidos: [],
            autoridades: [],
            honra: []
          };
          saveGuests();
          renderAllTables();
          updateStatistics('remidos');
          updateStatistics('autoridades');
          updateStatistics('honra');
          alert('‚úÖ Banco de dados exclu√≠do com sucesso!');
        }
      } else {
        alert('‚ùå Senha incorreta! O banco de dados n√£o foi exclu√≠do.');
      }
    }

    // Tab management
    function showTab(tabName) {
      // Hide all tabs
      document.querySelectorAll('.tab-content').forEach(tab => {
        tab.classList.remove('active');
      });
      document.querySelectorAll('.tab-btn').forEach(btn => {
        btn.classList.remove('active');
      });

      // Show selected tab
      document.getElementById('tab-' + tabName).classList.add('active');
      event.target.classList.add('active');
    }

    // Add guest
    function addGuest(type) {
      let guest = {};
      
      if (type === 'remidos') {
        const nome = document.getElementById('remidosNome').value.trim();
        const cro = document.getElementById('remidosCRO').value.trim();
        const categoria = document.getElementById('remidosCategoria').value;
        const email = document.getElementById('remidosEmail').value.trim();
        const telefone = document.getElementById('remidosTelefone').value.trim();
        const whatsapp = document.getElementById('remidosWhatsapp').value.trim();
        const nascimento = document.getElementById('remidosNascimento').value;
        const endereco = document.getElementById('remidosEndereco').value.trim();
        
        if (!nome || !cro) {
          alert('Por favor, preencha o nome e o CRO/RS');
          return;
        }
        
        guest = { nome, cro, categoria, email, telefone, whatsapp, nascimento, endereco, enviado: false, recebido: false, confirmado: false, convidadosExtras: 0, maxConvidadosExtras: 1 };
        
        // Clear form
        document.getElementById('remidosNome').value = '';
        document.getElementById('remidosCRO').value = '';
        document.getElementById('remidosCategoria').value = '';
        document.getElementById('remidosEmail').value = '';
        document.getElementById('remidosTelefone').value = '';
        document.getElementById('remidosWhatsapp').value = '';
        document.getElementById('remidosNascimento').value = '';
        document.getElementById('remidosEndereco').value = '';
      } else if (type === 'autoridades') {
        const nome = document.getElementById('autoridadesNome').value.trim();
        const cargo = document.getElementById('autoridadesCargo').value.trim();
        const email = document.getElementById('autoridadesEmail').value.trim();
        const telefone = document.getElementById('autoridadesTelefone').value.trim();
        const whatsapp = document.getElementById('autoridadesWhatsapp').value.trim();
        
        if (!nome || !cargo) {
          alert('Por favor, preencha o nome e o cargo');
          return;
        }
        
        guest = { nome, cargo, email, telefone, whatsapp, enviado: false, recebido: false, confirmado: false, convidadosExtras: 0, maxConvidadosExtras: 0 };
        
        // Clear form
        document.getElementById('autoridadesNome').value = '';
        document.getElementById('autoridadesCargo').value = '';
        document.getElementById('autoridadesEmail').value = '';
        document.getElementById('autoridadesTelefone').value = '';
        document.getElementById('autoridadesWhatsapp').value = '';
      } else if (type === 'honra') {
        const nome = document.getElementById('honraNome').value.trim();
        const categoria = document.getElementById('honraCategoria').value;
        const email = document.getElementById('honraEmail').value.trim();
        const telefone = document.getElementById('honraTelefone').value.trim();
        const whatsapp = document.getElementById('honraWhatsapp').value.trim();
        
        if (!nome) {
          alert('Por favor, preencha o nome');
          return;
        }
        
        guest = { nome, categoria, email, telefone, whatsapp, enviado: false, recebido: false, confirmado: false, convidadosExtras: 0, maxConvidadosExtras: 2 };
        
        // Clear form
        document.getElementById('honraNome').value = '';
        document.getElementById('honraEmail').value = '';
        document.getElementById('honraTelefone').value = '';
        document.getElementById('honraWhatsapp').value = '';
      }
      
      guestsData[type].push(guest);
      saveGuests();
      renderTable(type);
      renderCards(type);
      updateStatistics(type);
    }

    // Delete guest
    function deleteGuest(type, index) {
      if (confirm('Tem certeza que deseja remover este convidado?')) {
        guestsData[type].splice(index, 1);
        saveGuests();
        renderTable(type);
        renderCards(type);
        updateStatistics(type);
      }
    }

    // Edit guest
    function editGuest(type, index) {
      const guest = guestsData[type][index];
      
      if (type === 'remidos') {
        document.getElementById('remidosNome').value = guest.nome;
        document.getElementById('remidosCRO').value = guest.cro;
        document.getElementById('remidosCategoria').value = guest.categoria || '';
        document.getElementById('remidosEmail').value = guest.email || '';
        document.getElementById('remidosTelefone').value = guest.telefone || '';
        document.getElementById('remidosWhatsapp').value = guest.whatsapp || '';
        document.getElementById('remidosNascimento').value = guest.nascimento || '';
        document.getElementById('remidosEndereco').value = guest.endereco || '';
      } else if (type === 'autoridades') {
        document.getElementById('autoridadesNome').value = guest.nome;
        document.getElementById('autoridadesCargo').value = guest.cargo;
        document.getElementById('autoridadesEmail').value = guest.email || '';
        document.getElementById('autoridadesTelefone').value = guest.telefone || '';
        document.getElementById('autoridadesWhatsapp').value = guest.whatsapp || '';
      } else if (type === 'honra') {
        document.getElementById('honraNome').value = guest.nome;
        document.getElementById('honraCategoria').value = guest.categoria;
        document.getElementById('honraEmail').value = guest.email || '';
        document.getElementById('honraTelefone').value = guest.telefone || '';
        document.getElementById('honraWhatsapp').value = guest.whatsapp || '';
      }
      
      deleteGuest(type, index);
    }

    // Update status
    function updateStatus(type, index, field, value) {
      guestsData[type][index][field] = value === 'true';
      saveGuests();
      renderTable(type);
      renderCards(type);
      updateStatistics(type);
    }
    
    // Update extra guests
    function updateExtraGuests(type, index, value) {
      const numGuests = parseInt(value);
      const guest = guestsData[type][index];
      
      if (numGuests > guest.maxConvidadosExtras) {
        alert(`Este convidado pode trazer no m√°ximo ${guest.maxConvidadosExtras} convidado(s) extra(s).`);
        renderTable(type);
        return;
      }
      
      guest.convidadosExtras = numGuests;
      saveGuests();
      renderTable(type);
      renderCards(type);
    }

    // Render table
    function renderTable(type) {
      const tbody = document.getElementById(type + 'TableBody');
      tbody.innerHTML = '';
      
      guestsData[type].forEach((guest, index) => {
        const row = document.createElement('tr');
        
        let secondColumn = '';
        let thirdColumn = '';
        if (type === 'remidos') {
          secondColumn = guest.cro;
          const categoriaLabels = {
            'cientifico': 'Cient√≠fica',
            'politico': 'Pol√≠tica',
            'social': 'Social',
            'outro': 'Outro'
          };
          thirdColumn = guest.categoria ? (categoriaLabels[guest.categoria] || guest.categoria) : '-';
        } else if (type === 'autoridades') {
          secondColumn = guest.cargo;
        } else if (type === 'honra') {
          const categorias = {
            'cientifico': 'Cient√≠fica',
            'politico': 'Pol√≠tica',
            'social': 'Social'
          };
          secondColumn = categorias[guest.categoria] || guest.categoria;
        }
        
        // Ensure guest has extra guests properties
        if (guest.convidadosExtras === undefined) guest.convidadosExtras = 0;
        if (guest.maxConvidadosExtras === undefined) {
          if (type === 'remidos') guest.maxConvidadosExtras = 1;
          else if (type === 'honra') guest.maxConvidadosExtras = 2;
          else guest.maxConvidadosExtras = 0;
        }
        
        // Build extra guests column
        let extraGuestsColumn = '';
        if (guest.maxConvidadosExtras > 0) {
          extraGuestsColumn = `
            <select class="status-select" onchange="updateExtraGuests('${type}', ${index}, this.value)">
              ${Array.from({length: guest.maxConvidadosExtras + 1}, (_, i) => 
                `<option value="${i}" ${guest.convidadosExtras === i ? 'selected' : ''}>${i}</option>`
              ).join('')}
            </select>
            <small style="display: block; margin-top: 3px; color: #666; font-size: 0.85em;">m√°x: ${guest.maxConvidadosExtras}</small>
          `;
        } else {
          extraGuestsColumn = '<span style="color: #999;">N/A</span>';
        }
        
        // Format birth date if available
        let nascimentoFormatted = '-';
        if (type === 'remidos' && guest.nascimento) {
          try {
            const date = new Date(guest.nascimento);
            nascimentoFormatted = date.toLocaleDateString('pt-BR');
          } catch (e) {
            nascimentoFormatted = guest.nascimento;
          }
        }
        
        // Build row based on type
        if (type === 'remidos') {
          row.innerHTML = `
            <td>${guest.nome}</td>
            <td>${secondColumn}</td>
            <td>${thirdColumn}</td>
            <td>${guest.email || '-'}</td>
            <td>${guest.telefone || '-'}</td>
            <td>${guest.whatsapp || '-'}</td>
            <td>${nascimentoFormatted}</td>
            <td>${guest.endereco || '-'}</td>
            <td>
              <select class="status-select" onchange="updateStatus('${type}', ${index}, 'enviado', this.value)">
                <option value="false" ${!guest.enviado ? 'selected' : ''}>N√£o Enviado</option>
                <option value="true" ${guest.enviado ? 'selected' : ''}>Enviado</option>
              </select>
            </td>
            <td>
              <select class="status-select" onchange="updateStatus('${type}', ${index}, 'recebido', this.value)">
                <option value="false" ${!guest.recebido ? 'selected' : ''}>N√£o Confirmado</option>
                <option value="true" ${guest.recebido ? 'selected' : ''}>Confirmado</option>
              </select>
            </td>
            <td>
              <select class="status-select" onchange="updateStatus('${type}', ${index}, 'confirmado', this.value)">
                <option value="false" ${!guest.confirmado ? 'selected' : ''}>N√£o Confirmado</option>
                <option value="true" ${guest.confirmado ? 'selected' : ''}>Confirmado</option>
              </select>
            </td>
            <td>${extraGuestsColumn}</td>
            <td>
              <button class="action-btn edit" onclick="editGuest('${type}', ${index})">Editar</button>
              <button class="action-btn delete" onclick="deleteGuest('${type}', ${index})">Excluir</button>
            </td>
          `;
        } else {
          row.innerHTML = `
            <td>${guest.nome}</td>
            <td>${secondColumn}</td>
            <td>${guest.email || '-'}</td>
            <td>${guest.telefone || '-'}</td>
            <td>${guest.whatsapp || '-'}</td>
            <td>
              <select class="status-select" onchange="updateStatus('${type}', ${index}, 'enviado', this.value)">
                <option value="false" ${!guest.enviado ? 'selected' : ''}>N√£o Enviado</option>
                <option value="true" ${guest.enviado ? 'selected' : ''}>Enviado</option>
              </select>
            </td>
            <td>
              <select class="status-select" onchange="updateStatus('${type}', ${index}, 'recebido', this.value)">
                <option value="false" ${!guest.recebido ? 'selected' : ''}>N√£o Confirmado</option>
                <option value="true" ${guest.recebido ? 'selected' : ''}>Confirmado</option>
              </select>
            </td>
            <td>
              <select class="status-select" onchange="updateStatus('${type}', ${index}, 'confirmado', this.value)">
                <option value="false" ${!guest.confirmado ? 'selected' : ''}>N√£o Confirmado</option>
                <option value="true" ${guest.confirmado ? 'selected' : ''}>Confirmado</option>
              </select>
            </td>
            <td>${extraGuestsColumn}</td>
            <td>
              <button class="action-btn edit" onclick="editGuest('${type}', ${index})">Editar</button>
              <button class="action-btn delete" onclick="deleteGuest('${type}', ${index})">Excluir</button>
            </td>
          `;
        }
        
        tbody.appendChild(row);
      });
    }

    // Render all tables
    function renderAllTables() {
      renderTable('remidos');
      renderTable('autoridades');
      renderTable('honra');
      // Also render cards
      renderCards('remidos');
      renderCards('autoridades');
      renderCards('honra');
    }

    // Render guest cards
    function renderCards(type) {
      const container = document.getElementById(`${type}Cards`);
      if (!container) return;
      
      container.innerHTML = '';
      const guests = guestsData[type] || [];
      
      guests.forEach((guest, index) => {
        const card = document.createElement('div');
        card.className = 'guest-card';
        
        // Get initials for avatar
        const initials = guest.nome ? guest.nome.split(' ').map(n => n[0]).slice(0, 2).join('').toUpperCase() : '?';
        
        // Build card HTML
        let detailsHTML = '';
        if (type === 'remidos') {
          const categoriaLabels = {
            'cientifico': 'Cient√≠fica',
            'politico': 'Pol√≠tica',
            'social': 'Social',
            'outro': 'Outro'
          };
          let nascimentoStr = '';
          if (guest.nascimento) {
            try {
              const date = new Date(guest.nascimento);
              nascimentoStr = date.toLocaleDateString('pt-BR');
            } catch (e) {
              nascimentoStr = guest.nascimento;
            }
          }
          detailsHTML = `
            <div class="guest-detail"><span class="icon-id"></span> CRO/RS: ${guest.cro || 'N/A'}</div>
            ${guest.categoria ? `<div class="guest-detail">üè∑Ô∏è Categoria: ${categoriaLabels[guest.categoria] || guest.categoria}</div>` : ''}
            ${nascimentoStr ? `<div class="guest-detail">üéÇ Nascimento: ${nascimentoStr}</div>` : ''}
            ${guest.endereco ? `<div class="guest-detail">üìç Endere√ßo: ${guest.endereco}</div>` : ''}
          `;
        } else if (type === 'autoridades') {
          detailsHTML = `
            <div class="guest-detail"><span class="icon-briefcase"></span> ${guest.cargo || 'Cargo n√£o informado'}</div>
          `;
        } else if (type === 'honra') {
          const categoriaLabels = {
            'cientifico': 'Cient√≠fica',
            'politico': 'Pol√≠tica',
            'social': 'Social'
          };
          detailsHTML = `
            <div class="guest-detail"><span class="icon-trophy"></span> ${categoriaLabels[guest.categoria] || guest.categoria}</div>
          `;
        }
        
        // Add extra guests info if applicable
        if (guest.maxConvidadosExtras === undefined) {
          if (type === 'remidos') guest.maxConvidadosExtras = 1;
          else if (type === 'honra') guest.maxConvidadosExtras = 2;
          else guest.maxConvidadosExtras = 0;
        }
        if (guest.convidadosExtras === undefined) guest.convidadosExtras = 0;
        
        let extraGuestsHTML = '';
        if (guest.maxConvidadosExtras > 0) {
          extraGuestsHTML = `
            <div class="guest-detail" style="margin-top: 8px; padding-top: 8px; border-top: 1px solid #e0e0e0;">
              üë• Convidados Extras: ${guest.convidadosExtras}/${guest.maxConvidadosExtras}
            </div>
          `;
        }
        
        card.innerHTML = `
          <div class="guest-card-header">
            <div class="guest-avatar">${initials}</div>
            <div class="guest-info">
              <div class="guest-name">${guest.nome || 'Nome n√£o informado'}</div>
              ${detailsHTML}
              <div class="guest-detail"><span class="icon-email"></span> ${guest.email || 'N/A'}</div>
              <div class="guest-detail"><span class="icon-phone"></span> ${guest.telefone || 'N/A'}</div>
              <div class="guest-detail">üì± WhatsApp: ${guest.whatsapp || 'N/A'}</div>
              ${extraGuestsHTML}
            </div>
          </div>
          <div class="guest-status-row">
            <span class="status-badge ${guest.enviado ? 'sent' : 'pending'}">
              ${guest.enviado ? '‚úÖ Enviado' : '‚è≥ Pendente'}
            </span>
            <span class="status-badge ${guest.recebido ? 'confirmed' : 'pending'}">
              ${guest.recebido ? '‚úÖ Recebido' : '‚è≥ Aguardando'}
            </span>
            <span class="status-badge ${guest.confirmado ? 'confirmed' : 'pending'}">
              ${guest.confirmado ? '‚úÖ Confirmado' : '‚ùì N√£o confirmado'}
            </span>
          </div>
          <div class="guest-actions">
            <button class="guest-action-btn edit" onclick="editGuest('${type}', ${index})">‚úèÔ∏è Editar</button>
            <button class="guest-action-btn delete" onclick="deleteGuest('${type}', ${index})">üóëÔ∏è Remover</button>
          </div>
        `;
        
        container.appendChild(card);
      });
      
      if (guests.length === 0) {
        container.innerHTML = '<p style="text-align: center; color: #78909c; padding: 40px;">Nenhum convidado cadastrado ainda.</p>';
      }
    }

    // Toggle between card and table view
    function toggleView(type) {
      const cardsContainer = document.getElementById(`${type}Cards`);
      const tableContainer = document.getElementById(`${type}TableContainer`);
      const toggleBtn = document.getElementById(`${type}ViewToggle`);
      
      if (cardsContainer.style.display === 'none') {
        // Switch to cards view
        cardsContainer.style.display = 'grid';
        tableContainer.style.display = 'none';
        toggleBtn.textContent = 'üìã Ver Tabela';
      } else {
        // Switch to table view
        cardsContainer.style.display = 'none';
        tableContainer.style.display = 'block';
        toggleBtn.textContent = 'üé¥ Ver Cards';
      }
    }

    // Update statistics counters
    function updateStatistics(type) {
      const guests = guestsData[type] || [];
      const total = guests.length;
      const enviado = guests.filter(g => g.enviado).length;
      const recebido = guests.filter(g => g.recebido).length;
      const confirmado = guests.filter(g => g.confirmado).length;
      
      document.getElementById(`${type}-total-count`).textContent = total;
      document.getElementById(`${type}-enviado-count`).textContent = enviado;
      document.getElementById(`${type}-recebido-count`).textContent = recebido;
      document.getElementById(`${type}-confirmado-count`).textContent = confirmado;
    }

    // Update all statistics
    function updateAllStatistics() {
      updateStatistics('remidos');
      updateStatistics('autoridades');
      updateStatistics('honra');
    }

    // Store filtered data for each type
    let filteredData = {
      remidos: null,
      autoridades: null,
      honra: null
    };

    // Apply filters
    function applyFilters(type) {
      const filterEnviado = document.getElementById(`${type}-filter-enviado`).value;
      const filterRecebido = document.getElementById(`${type}-filter-recebido`).value;
      const filterConfirmado = document.getElementById(`${type}-filter-confirmado`).value;
      const filterContato = document.getElementById(`${type}-filter-contato`).value;
      
      let filtered = [...guestsData[type]];
      
      // Apply enviado filter
      if (filterEnviado !== 'all') {
        filtered = filtered.filter(g => g.enviado === (filterEnviado === 'true'));
      }
      
      // Apply recebido filter
      if (filterRecebido !== 'all') {
        filtered = filtered.filter(g => g.recebido === (filterRecebido === 'true'));
      }
      
      // Apply confirmado filter
      if (filterConfirmado !== 'all') {
        filtered = filtered.filter(g => g.confirmado === (filterConfirmado === 'true'));
      }
      
      // Apply contato filter
      if (filterContato !== 'all') {
        filtered = filtered.filter(g => {
          if (filterContato === 'email') return g.email && g.email.trim() !== '';
          if (filterContato === 'telefone') return g.telefone && g.telefone.trim() !== '';
          if (filterContato === 'whatsapp') return g.whatsapp && g.whatsapp.trim() !== '';
          return true;
        });
      }
      
      // Store filtered data
      filteredData[type] = filtered;
      
      // Render filtered data
      renderFilteredGuests(type, filtered);
      
      // Show notification
      alert(`Filtros aplicados! Exibindo ${filtered.length} de ${guestsData[type].length} convidados.`);
    }

    // Clear filters
    function clearFilters(type) {
      document.getElementById(`${type}-filter-enviado`).value = 'all';
      document.getElementById(`${type}-filter-recebido`).value = 'all';
      document.getElementById(`${type}-filter-confirmado`).value = 'all';
      document.getElementById(`${type}-filter-contato`).value = 'all';
      
      filteredData[type] = null;
      renderTable(type);
      renderCards(type);
      
      alert('Filtros limpos! Exibindo todos os convidados.');
    }

    // Render filtered guests
    function renderFilteredGuests(type, filtered) {
      // Temporarily replace guestsData with filtered data for rendering
      const original = guestsData[type];
      guestsData[type] = filtered;
      renderTable(type);
      renderCards(type);
      guestsData[type] = original;
    }

    // Generate PDF report
    function generateReport(type) {
      const { jsPDF } = window.jspdf;
      
      // Get data to report (filtered or all)
      const dataToReport = filteredData[type] || guestsData[type];
      
      if (dataToReport.length === 0) {
        alert('N√£o h√° dados para gerar o relat√≥rio!');
        return;
      }
      
      const pdf = new jsPDF();
      const pageWidth = pdf.internal.pageSize.getWidth();
      const pageHeight = pdf.internal.pageSize.getHeight();
      const margin = 15;
      let yPosition = margin;
      
      // Title
      pdf.setFontSize(18);
      pdf.setFont(undefined, 'bold');
      const titleMap = {
        'remidos': 'Relat√≥rio de Remidos',
        'autoridades': 'Relat√≥rio de Autoridades',
        'honra': 'Relat√≥rio de Honra ao M√©rito'
      };
      pdf.text(titleMap[type], margin, yPosition);
      yPosition += 10;
      
      // Date
      pdf.setFontSize(10);
      pdf.setFont(undefined, 'normal');
      pdf.text(`Gerado em: ${new Date().toLocaleDateString('pt-BR')} √†s ${new Date().toLocaleTimeString('pt-BR')}`, margin, yPosition);
      yPosition += 5;
      
      // Statistics
      const total = dataToReport.length;
      const enviado = dataToReport.filter(g => g.enviado).length;
      const recebido = dataToReport.filter(g => g.recebido).length;
      const confirmado = dataToReport.filter(g => g.confirmado).length;
      
      pdf.text(`Total de Convidados: ${total}`, margin, yPosition);
      yPosition += 5;
      pdf.text(`Convites Enviados: ${enviado}`, margin, yPosition);
      yPosition += 5;
      pdf.text(`Recebimentos Confirmados: ${recebido}`, margin, yPosition);
      yPosition += 5;
      pdf.text(`Presen√ßas Confirmadas: ${confirmado}`, margin, yPosition);
      yPosition += 10;
      
      // Line separator
      pdf.setDrawColor(200, 200, 200);
      pdf.line(margin, yPosition, pageWidth - margin, yPosition);
      yPosition += 10;
      
      // Guest list
      pdf.setFontSize(12);
      pdf.setFont(undefined, 'bold');
      pdf.text('Lista de Convidados:', margin, yPosition);
      yPosition += 8;
      
      pdf.setFontSize(9);
      pdf.setFont(undefined, 'normal');
      
      dataToReport.forEach((guest, index) => {
        // Check if we need a new page
        if (yPosition > pageHeight - 30) {
          pdf.addPage();
          yPosition = margin;
        }
        
        // Guest number
        pdf.setFont(undefined, 'bold');
        pdf.text(`${index + 1}. ${guest.nome}`, margin, yPosition);
        yPosition += 5;
        
        pdf.setFont(undefined, 'normal');
        
        // Second column (CRO, Cargo, or Category)
        if (type === 'remidos') {
          pdf.text(`   CRO/RS: ${guest.cro || 'N/A'}`, margin, yPosition);
        } else if (type === 'autoridades') {
          pdf.text(`   Cargo: ${guest.cargo || 'N/A'}`, margin, yPosition);
        } else if (type === 'honra') {
          const categorias = {
            'cientifico': 'Cient√≠fica',
            'politico': 'Pol√≠tica',
            'social': 'Social'
          };
          pdf.text(`   Categoria: ${categorias[guest.categoria] || guest.categoria}`, margin, yPosition);
        }
        yPosition += 5;
        
        // Contact info
        pdf.text(`   E-mail: ${guest.email || 'N/A'}`, margin, yPosition);
        yPosition += 4;
        pdf.text(`   Telefone: ${guest.telefone || 'N/A'}`, margin, yPosition);
        yPosition += 4;
        pdf.text(`   WhatsApp: ${guest.whatsapp || 'N/A'}`, margin, yPosition);
        yPosition += 5;
        
        // Status
        const statusEnviado = guest.enviado ? '‚úì Enviado' : '‚úó N√£o Enviado';
        const statusRecebido = guest.recebido ? '‚úì Confirmado' : '‚úó N√£o Confirmado';
        const statusConfirmado = guest.confirmado ? '‚úì Confirmado' : '‚úó N√£o Confirmado';
        
        pdf.text(`   Convite: ${statusEnviado} | Recebimento: ${statusRecebido} | Presen√ßa: ${statusConfirmado}`, margin, yPosition);
        yPosition += 8;
      });
      
      // Footer
      const totalPages = pdf.internal.getNumberOfPages();
      for (let i = 1; i <= totalPages; i++) {
        pdf.setPage(i);
        pdf.setFontSize(8);
        pdf.setTextColor(150);
        pdf.text(`P√°gina ${i} de ${totalPages}`, pageWidth - margin - 20, pageHeight - 10);
        pdf.text('CRO/RS - Sistema de Gerenciamento de Convidados', margin, pageHeight - 10);
      }
      
      // Save PDF
      const fileName = `relatorio_${type}_${new Date().getTime()}.pdf`;
      pdf.save(fileName);
      
      alert(`Relat√≥rio gerado com sucesso! ${dataToReport.length} convidados inclu√≠dos.`);
    }

    // Download Template Function
    function downloadTemplate(type) {
      if (type === 'remidos') {
        // Create template data
        const templateData = [
          {
            'nome': 'Jo√£o da Silva',
            'cro': '12345',
            'CATEGORIA': 'Cient√≠fica',
            'telefone': '(51) 99999-9999',
            'email': 'joao@example.com',
            'NASCIMENTO': '1980-01-15',
            'ENDERE√áO': 'Rua Exemplo, 123 - Centro - Porto Alegre/RS'
          },
          {
            'nome': 'Maria Santos',
            'cro': '67890',
            'CATEGORIA': 'Social',
            'telefone': '(51) 98888-8888',
            'email': 'maria@example.com',
            'NASCIMENTO': '1985-05-20',
            'ENDERE√áO': 'Av. Prot√°sio Alves, 456 - Petr√≥polis - Porto Alegre/RS'
          }
        ];
        
        // Create workbook
        const ws = XLSX.utils.json_to_sheet(templateData);
        const wb = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(wb, ws, 'Remidos');
        
        // Download Excel file
        XLSX.writeFile(wb, 'template_remidos.xlsx');
        
        // Also create CSV
        const csvContent = 'nome,cro,CATEGORIA,telefone,email,NASCIMENTO,ENDERE√áO\n' +
          'Jo√£o da Silva,12345,Cient√≠fica,(51) 99999-9999,joao@example.com,1980-01-15,"Rua Exemplo, 123 - Centro - Porto Alegre/RS"\n' +
          'Maria Santos,67890,Social,(51) 98888-8888,maria@example.com,1985-05-20,"Av. Prot√°sio Alves, 456 - Petr√≥polis - Porto Alegre/RS"';
        
        const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
        const link = document.createElement('a');
        link.href = URL.createObjectURL(blob);
        link.download = 'template_remidos.csv';
        link.click();
        
        alert('‚úÖ Modelos baixados com sucesso!\n\nForam baixados dois arquivos:\n‚Ä¢ template_remidos.xlsx (Excel)\n‚Ä¢ template_remidos.csv (CSV)\n\nUse qualquer um deles como exemplo para importar seus dados.');
      }
    }

    // Excel Import Functionality for Guest Management
    function setupExcelImport(type) {
      const fileInputId = type + 'ExcelFile';
      const fileInput = document.getElementById(fileInputId);
      
      if (!fileInput) return;
      
      fileInput.addEventListener('change', function(e) {
        const file = e.target.files[0];
        if (!file) return;
        
        const isCSV = file.name.toLowerCase().endsWith('.csv');
        const reader = new FileReader();
        
        reader.onload = function(e) {
          try {
            let jsonData;
            
            if (isCSV) {
              // Handle CSV file
              const text = e.target.result;
              const lines = text.split('\n');
              const headers = lines[0].split(',').map(h => h.trim().replace(/["\r]/g, ''));
              
              jsonData = [];
              for (let i = 1; i < lines.length; i++) {
                if (!lines[i].trim()) continue;
                
                const values = lines[i].split(',').map(v => v.trim().replace(/["\r]/g, ''));
                const row = {};
                headers.forEach((header, index) => {
                  row[header] = values[index] || '';
                });
                jsonData.push(row);
              }
            } else {
              // Handle Excel file
              const data = new Uint8Array(e.target.result);
              const workbook = XLSX.read(data, { type: 'array' });
              
              // Get first sheet
              const firstSheetName = workbook.SheetNames[0];
              const worksheet = workbook.Sheets[firstSheetName];
              
              // Convert to JSON
              jsonData = XLSX.utils.sheet_to_json(worksheet);
            }
            
            if (jsonData.length > 0) {
              let importCount = 0;
              let errors = [];
              
              // Helper function to find column value with multiple possible names
              const findColumn = (row, possibleNames) => {
                for (let key in row) {
                  if (possibleNames.some(name => key.toLowerCase().includes(name.toLowerCase()))) {
                    return row[key];
                  }
                }
                return '';
              };
              
              jsonData.forEach((row, index) => {
                try {
                  const nome = findColumn(row, ['nome', 'name']);
                  const email = findColumn(row, ['email', 'e-mail', 'mail']);
                  const telefone = findColumn(row, ['telefone celular', 'telefone', 'celular', 'phone', 'tel']);
                  const whatsapp = findColumn(row, ['whatsapp', 'zap', 'wpp']);
                  
                  if (!nome) {
                    errors.push(`Linha ${index + 2}: Nome n√£o encontrado`);
                    return;
                  }
                  
                  let guest = {};
                  
                  if (type === 'remidos') {
                    const cro = findColumn(row, ['n¬∫ cro', 'cro', 'numero cro', 'cro/rs']);
                    if (!cro) {
                      errors.push(`Linha ${index + 2}: CRO n√£o encontrado para ${nome}`);
                      return;
                    }
                    
                    // For Remidos, only auto-fill name and CRO number, ignoring other fields
                    guest = {
                      nome: String(nome).trim(),
                      cro: String(cro).trim(),
                      categoria: '',
                      email: '',
                      telefone: '',
                      whatsapp: '',
                      nascimento: '',
                      endereco: '',
                      enviado: false,
                      recebido: false,
                      confirmado: false,
                      convidadosExtras: 0,
                      maxConvidadosExtras: 1
                    };
                  } else if (type === 'autoridades') {
                    const cargo = findColumn(row, ['cargo', 'institui√ß√£o', 'instituicao', 'position']);
                    if (!cargo) {
                      errors.push(`Linha ${index + 2}: Cargo n√£o encontrado para ${nome}`);
                      return;
                    }
                    guest = {
                      nome: String(nome).trim(),
                      cargo: String(cargo).trim(),
                      email: email ? String(email).trim() : '',
                      telefone: telefone ? String(telefone).trim() : whatsapp ? String(whatsapp).trim() : '',
                      whatsapp: whatsapp ? String(whatsapp).trim() : telefone ? String(telefone).trim() : '',
                      enviado: false,
                      recebido: false,
                      confirmado: false,
                      convidadosExtras: 0,
                      maxConvidadosExtras: 0
                    };
                  } else if (type === 'honra') {
                    const categoria = findColumn(row, ['categoria', 'category']);
                    let categoriaValue = 'cientifico'; // default
                    
                    if (categoria) {
                      const catStr = String(categoria).toLowerCase();
                      if (catStr.includes('cient√≠f') || catStr.includes('cientif')) {
                        categoriaValue = 'cientifico';
                      } else if (catStr.includes('pol√≠t') || catStr.includes('polit')) {
                        categoriaValue = 'politico';
                      } else if (catStr.includes('social')) {
                        categoriaValue = 'social';
                      }
                    }
                    
                    guest = {
                      nome: String(nome).trim(),
                      categoria: categoriaValue,
                      email: email ? String(email).trim() : '',
                      telefone: telefone ? String(telefone).trim() : whatsapp ? String(whatsapp).trim() : '',
                      whatsapp: whatsapp ? String(whatsapp).trim() : telefone ? String(telefone).trim() : '',
                      enviado: false,
                      recebido: false,
                      confirmado: false,
                      convidadosExtras: 0,
                      maxConvidadosExtras: 2
                    };
                  }
                  
                  guestsData[type].push(guest);
                  importCount++;
                } catch (error) {
                  errors.push(`Linha ${index + 2}: Erro ao processar - ${error.message}`);
                }
              });
              
              saveGuests();
              renderTable(type);
              renderCards(type);
              updateStatistics(type);
              
              let message = `‚úÖ Importa√ß√£o conclu√≠da!\n${importCount} convidado(s) importado(s) com sucesso.`;
              if (errors.length > 0) {
                message += `\n\n‚ö†Ô∏è Erros encontrados (${errors.length}):\n` + errors.slice(0, 5).join('\n');
                if (errors.length > 5) {
                  message += `\n... e mais ${errors.length - 5} erro(s)`;
                }
              }
              alert(message);
              
              // Clear file input
              fileInput.value = '';
            } else {
              alert('‚ùå O arquivo Excel est√° vazio.');
            }
          } catch (error) {
            console.error('Erro ao processar arquivo:', error);
            alert('‚ùå Erro ao processar arquivo. Verifique se o formato est√° correto.\n\n' + error.message);
          }
        };
        
        // Read file based on type
        if (isCSV) {
          reader.readAsText(file);
        } else {
          reader.readAsArrayBuffer(file);
        }
      });
    }
    
    // Setup Excel import for all guest types
    setupExcelImport('remidos');
    setupExcelImport('autoridades');
    setupExcelImport('honra');

    // Initialize on load
    loadGuests();
    updateAllStatistics();
  </script>
</body>
</html>
