<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gerador de Convites - CRO/RS</title>
  <style>
    * {
      box-sizing: border-box;
    }
    
    body {
      background: linear-gradient(135deg, #1a237e 0%, #283593 50%, #1a237e 100%);
      font-family: 'Cormorant Garamond', 'Playfair Display', 'Inter', 'Roboto', serif;
      color: #2c3e50;
      margin: 0;
      padding: 0;
      min-height: 100vh;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 20px;
    }

    /* Welcome Screen */
    .welcome-screen {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      text-align: center;
      color: white;
      padding: 40px 20px;
    }

    .welcome-screen.hidden {
      display: none;
    }

    .logo-container {
      margin-bottom: 40px;
    }

    .logo-container img {
      width: 120px;
      height: 120px;
      filter: brightness(0) invert(1);
    }

    .welcome-title {
      font-size: 3em;
      font-weight: 700;
      margin-bottom: 20px;
      letter-spacing: 2px;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
    }

    .welcome-subtitle {
      font-size: 1.5em;
      margin-bottom: 40px;
      opacity: 0.9;
    }

    .welcome-description {
      max-width: 600px;
      font-size: 1.1em;
      line-height: 1.8;
      margin-bottom: 50px;
      opacity: 0.85;
    }

    .btn-create {
      background: linear-gradient(135deg, #d4af37 0%, #f4d03f 100%);
      color: #1a237e;
      padding: 18px 50px;
      font-size: 1.3em;
      font-weight: 600;
      border: none;
      border-radius: 50px;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(212, 175, 55, 0.3);
    }

    .btn-create:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(212, 175, 55, 0.5);
    }

    /* Editor Screen */
    .editor-screen {
      display: none;
      background: #f5f7fa;
      min-height: 100vh;
      padding: 30px 0;
    }

    .editor-screen.active {
      display: block;
    }

    .header-bar {
      background: white;
      padding: 20px 0;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      margin-bottom: 30px;
    }

    .header-bar .container {
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .brand img {
      width: 50px;
      height: 50px;
    }

    .brand-text h1 {
      font-size: 1.5em;
      color: #1a237e;
      margin: 0;
      font-weight: 700;
    }

    .brand-text p {
      font-size: 0.9em;
      color: #d4af37;
      margin: 0;
    }

    .main-title {
      text-align: center;
      color: #1a237e;
      font-size: 2.5em;
      font-weight: 700;
      margin-bottom: 10px;
      letter-spacing: 1px;
    }

    .main-subtitle {
      text-align: center;
      color: #5c6bc0;
      font-size: 1.3em;
      margin-bottom: 40px;
    }

    .grid-container {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 30px;
      align-items: start;
    }

    @media (max-width: 968px) {
      .grid-container {
        grid-template-columns: 1fr;
      }
    }

    .form-section {
      background: #fff;
      border-radius: 16px;
      padding: 30px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
    }

    .form-section h2 {
      color: #1a237e;
      margin-top: 0;
      font-size: 1.6em;
      margin-bottom: 24px;
      font-weight: 600;
    }

    .section-title {
      color: #1a237e;
      font-size: 1.3em;
      font-weight: 600;
      margin-top: 30px;
      margin-bottom: 15px;
      padding-bottom: 10px;
      border-bottom: 2px solid #e8eaf6;
    }

    .section-title:first-child {
      margin-top: 0;
    }

    .form-group {
      margin-bottom: 20px;
    }

    .form-group label {
      display: block;
      font-weight: 500;
      color: #37474f;
      margin-bottom: 8px;
      font-size: 0.95em;
    }

    .form-group input,
    .form-group textarea,
    .form-group select {
      width: 100%;
      padding: 12px 16px;
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      font-family: 'Inter', 'Roboto', sans-serif;
      font-size: 1em;
      color: #2c3e50;
      transition: all 0.3s;
      background: #fafafa;
    }

    .form-group input:focus,
    .form-group textarea:focus,
    .form-group select:focus {
      outline: none;
      border-color: #5c6bc0;
      background: white;
      box-shadow: 0 0 0 3px rgba(92, 107, 192, 0.1);
    }

    .form-group textarea {
      resize: vertical;
      min-height: 100px;
    }

    .form-group select {
      cursor: pointer;
    }

    /* Template Selector */
    .template-selector {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 15px;
      margin-bottom: 20px;
    }

    .template-option {
      border: 3px solid #e0e0e0;
      border-radius: 12px;
      padding: 20px;
      cursor: pointer;
      transition: all 0.3s;
      text-align: center;
      background: white;
    }

    .template-option:hover {
      border-color: #5c6bc0;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(92, 107, 192, 0.2);
    }

    .template-option.active {
      border-color: #1a237e;
      background: #e8eaf6;
    }

    .template-option input[type="radio"] {
      display: none;
    }

    .template-name {
      font-weight: 600;
      color: #1a237e;
      font-size: 1.1em;
      margin-bottom: 5px;
    }

    .template-description {
      font-size: 0.85em;
      color: #78909c;
    }

    /* Checkbox Group */
    .checkbox-group {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-top: 10px;
    }

    .checkbox-group input[type="checkbox"] {
      width: auto;
      margin: 0;
    }

    .checkbox-group label {
      margin: 0;
      cursor: pointer;
    }

    /* Base Invitation Container */
    .convite-container {
      max-width: 600px;
      margin: 0 auto;
      background: #fff;
      border-radius: 16px;
      box-shadow: 0 4px 24px rgba(0, 0, 0, 0.1);
      padding: 40px;
      position: relative;
    }

    /* Formal Template */
    .convite-container.template-formal {
      border: 4px solid;
      border-image: linear-gradient(135deg, #d4af37 40%, #fffbe8 60%, #d4af37 100%) 1;
      box-shadow: 0 8px 32px rgba(44, 82, 130, 0.12), inset 0 0 0 1px rgba(212, 175, 55, 0.1);
    }

    .convite-container.template-formal:before {
      content: "";
      position: absolute;
      inset: 10px;
      border-radius: 12px;
      pointer-events: none;
      border: 2px dashed #d4af37;
      opacity: 0.6;
    }

    .convite-container.template-formal .header h1 {
      background: linear-gradient(135deg, #1a237e 0%, #283593 50%, #1a237e 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      text-shadow: none;
    }

    /* Modern Template */
    .convite-container.template-modern {
      border-left: 8px solid #1a237e;
      background: linear-gradient(135deg, #ffffff 0%, #f5f7fa 100%);
    }

    /* Classic Template */
    .convite-container.template-classic {
      border: 3px double #d4af37;
      background: #fffef9;
    }

    .convite-container.template-classic:before {
      content: "";
      position: absolute;
      top: 15px;
      left: 15px;
      right: 15px;
      bottom: 15px;
      border: 1px solid #d4af37;
      pointer-events: none;
    }

    /* Minimalist Template */
    .convite-container.template-minimalist {
      border: 1px solid #e0e0e0;
      background: white;
      box-shadow: 0 2px 12px rgba(0, 0, 0, 0.05);
    }

    .header {
      text-align: center;
      margin-bottom: 30px;
    }

    .header .logo-dual {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 30px;
      margin-bottom: 20px;
      padding: 10px;
    }

    .header .logo-dual img {
      width: 80px;
      height: 80px;
      object-fit: contain;
      filter: drop-shadow(0 2px 4px rgba(0,0,0,0.1));
    }

    .header .logo-dual .divider {
      width: 3px;
      height: 80px;
      background: linear-gradient(to bottom, 
        transparent 0%, 
        rgba(212, 175, 55, 0.3) 10%,
        rgba(212, 175, 55, 0.8) 50%, 
        rgba(212, 175, 55, 0.3) 90%,
        transparent 100%);
      box-shadow: 0 0 10px rgba(212, 175, 55, 0.3);
    }

    .header img {
      width: 80px;
      margin-bottom: 15px;
    }

    .header h1 {
      font-size: 2.5em;
      color: #1a237e;
      margin: 0 0 10px 0;
      font-weight: 700;
      letter-spacing: 2px;
      font-family: 'Playfair Display', serif;
    }

    .template-modern .header h1 {
      font-size: 2em;
      font-weight: 600;
    }

    .template-minimalist .header h1 {
      font-size: 1.8em;
      font-weight: 500;
    }

    .sub-title {
      text-align: center;
      color: #5c6bc0;
      font-size: 1.2em;
      font-weight: 500;
      margin-bottom: 30px;
    }

    .template-modern .sub-title {
      color: #d4af37;
    }

    .content {
      font-size: 1.15em;
      line-height: 2;
      color: #2c3e50;
      margin-bottom: 30px;
      text-align: justify;
      font-family: 'Cormorant Garamond', serif;
    }

    .content strong {
      color: #1a237e;
      font-weight: 600;
    }

    .template-modern .content strong {
      color: #d4af37;
    }

    .footer {
      text-align: right;
      color: #d4af37;
      font-size: 1.05em;
      margin-top: 40px;
      font-weight: 500;
      font-style: italic;
      letter-spacing: 0.5px;
    }

    .template-minimalist .footer {
      color: #78909c;
    }

    .qr-code-container {
      text-align: center;
      margin-top: 30px;
      padding-top: 20px;
      border-top: 1px solid #e0e0e0;
    }

    .qr-code-container img {
      width: 120px;
      height: 120px;
      margin-bottom: 10px;
    }

    .qr-code-label {
      font-size: 0.9em;
      color: #78909c;
    }

    .placeholder {
      color: #999;
      font-style: italic;
    }

    .preview-title {
      text-align: center;
      color: #1a237e;
      font-size: 1.6em;
      font-weight: 600;
      margin-bottom: 24px;
    }

    /* Action Buttons */
    .actions-container {
      background: white;
      border-radius: 16px;
      padding: 25px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
      margin-top: 20px;
    }

    .actions-title {
      color: #1a237e;
      font-size: 1.3em;
      font-weight: 600;
      margin-bottom: 20px;
      text-align: center;
    }

    .action-buttons {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
    }

    .btn {
      padding: 12px 20px;
      border: none;
      border-radius: 8px;
      font-size: 0.95em;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      font-family: 'Inter', 'Roboto', sans-serif;
    }

    .btn-primary {
      background: linear-gradient(135deg, #1a237e 0%, #283593 100%);
      color: white;
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(26, 35, 126, 0.3);
    }

    .btn-secondary {
      background: linear-gradient(135deg, #d4af37 0%, #f4d03f 100%);
      color: #1a237e;
    }

    .btn-secondary:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(212, 175, 55, 0.3);
    }

    .btn-success {
      background: #43a047;
      color: white;
    }

    .btn-success:hover {
      background: #388e3c;
      transform: translateY(-2px);
    }

    .btn-info {
      background: #0288d1;
      color: white;
    }

    .btn-info:hover {
      background: #0277bd;
      transform: translateY(-2px);
    }

    @media (max-width: 640px) {
      .action-buttons {
        grid-template-columns: 1fr;
      }
    }

    @media print {
      .form-section,
      .main-title,
      .main-subtitle,
      .preview-title,
      .actions-container,
      .header-bar {
        display: none;
      }

      .grid-container {
        display: block;
      }

      body {
        padding: 0;
        background: white;
      }

      .editor-screen {
        padding: 0;
      }
    }
  </style>
  <!-- Fontes elegantes do Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;500;600;700&family=Playfair+Display:wght@400;500;600;700&family=Inter:wght@400;500;600;700&family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
</head>
<body>
  <!-- Welcome Screen -->
  <div class="welcome-screen" id="welcomeScreen">
    <div class="logo-container">
      <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/0/07/Caduceus.svg/1200px-Caduceus.svg.png" alt="Logo CRO/RS">
    </div>
    <h1 class="welcome-title">Gerador de Convites CRO/RS</h1>
    <p class="welcome-subtitle">Sistema Profissional de Gera√ß√£o de Convites</p>
    <div class="welcome-description">
      <p>Crie convites personalizados e profissionais para seus eventos do CRO/RS.</p>
      <p>Escolha entre m√∫ltiplos modelos, personalize os detalhes e compartilhe de forma f√°cil.</p>
    </div>
    <button class="btn-create" onclick="showEditor()">Criar Convite</button>
  </div>

  <!-- Editor Screen -->
  <div class="editor-screen" id="editorScreen">
    <div class="header-bar">
      <div class="container">
        <div class="brand">
          <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/0/07/Caduceus.svg/1200px-Caduceus.svg.png" alt="Logo CRO/RS">
          <div class="brand-text">
            <h1>Gerador de Convites</h1>
            <p>CRO/RS</p>
          </div>
        </div>
      </div>
    </div>

    <div class="container">
      <div class="grid-container">
        <!-- Formul√°rio -->
        <div>
          <div class="form-section">
            <h2>Configura√ß√£o do Convite</h2>
            
            <h3 class="section-title">Modelo do Convite</h3>
            <div class="template-selector">
              <label class="template-option active" data-template="formal">
                <input type="radio" name="template" value="formal" checked>
                <div class="template-name">Formal</div>
                <div class="template-description">Elegante e tradicional</div>
              </label>
              <label class="template-option" data-template="modern">
                <input type="radio" name="template" value="modern">
                <div class="template-name">Moderno</div>
                <div class="template-description">Limpo e contempor√¢neo</div>
              </label>
              <label class="template-option" data-template="classic">
                <input type="radio" name="template" value="classic">
                <div class="template-name">Cl√°ssico</div>
                <div class="template-description">Sofisticado e atemporal</div>
              </label>
              <label class="template-option" data-template="minimalist">
                <input type="radio" name="template" value="minimalist">
                <div class="template-name">Minimalista</div>
                <div class="template-description">Simples e direto</div>
              </label>
            </div>

            <h3 class="section-title">Dados do Convite</h3>
            
            <div class="form-group">
              <label for="textoModelo">Modelo de Texto:</label>
              <select id="textoModelo">
                <option value="padrao">Modelo Padr√£o</option>
                <option value="cientifico">Pr√™mio Cient√≠fico ‚Äì CD Ant√¥nio Augusto Pretto</option>
                <option value="politico">Pr√™mio Pol√≠tico ‚Äì CD Jair Soares</option>
                <option value="social">Pr√™mio Social ‚Äì CD Fl√°vio Ant√¥nio Luce</option>
                <option value="autoridades">Modelo para Autoridades</option>
                <option value="remidos">Modelo Remidos</option>
              </select>
            </div>

            <div class="form-group">
              <label for="tipoEvento">Tipo de Evento:</label>
              <select id="tipoEvento">
                <option value="solenidade">Solenidade</option>
                <option value="reuniao">Reuni√£o</option>
                <option value="comemoracao">Comemora√ß√£o</option>
                <option value="outro">Outro</option>
              </select>
            </div>

            <div class="form-group">
              <label for="nomeConvidado">Nome do Convidado:</label>
              <input type="text" id="nomeConvidado" placeholder="Digite o nome do convidado">
            </div>

            <div class="form-group">
              <label for="dataEvento">Data do Evento:</label>
              <input type="text" id="dataEvento" placeholder="Ex: 15 de dezembro de 2024">
            </div>

            <div class="form-group">
              <label for="localEvento">Local do Evento:</label>
              <input type="text" id="localEvento" placeholder="Digite o local do evento">
            </div>

            <div class="form-group">
              <label for="horarioEvento">Hor√°rio:</label>
              <input type="text" id="horarioEvento" placeholder="Ex: 19h00">
            </div>

            <div class="form-group">
              <label for="mensagemPersonalizada">Mensagem Personalizada:</label>
              <textarea id="mensagemPersonalizada" placeholder="Digite uma mensagem especial (opcional)"></textarea>
            </div>

            <h3 class="section-title">Op√ß√µes Adicionais</h3>

            <div class="form-group">
              <label for="excelFile">Importar dados do Excel:</label>
              <input type="file" id="excelFile" accept=".xlsx,.xls,.csv,.xlsm,.xlsb" style="padding: 8px; background: white;">
              <small style="display: block; margin-top: 5px; color: #78909c; font-size: 0.85em;">
                <strong>Formatos aceitos:</strong> .xlsx, .xls, .csv, .xlsm, .xlsb (qualquer tipo de Excel)<br>
                <strong>Estrutura esperada:</strong> O arquivo deve conter colunas com nomes como: Nome/Name/Convidado, Data/Date/Dia, Local/Lugar/Location, Hor√°rio/Horario/Hora/Time<br>
                <strong>Como usar:</strong> Selecione o arquivo e os dados da primeira linha ser√£o importados automaticamente para o formul√°rio.
              </small>
            </div>

            <div class="checkbox-group">
              <input type="checkbox" id="incluirQRCode">
              <label for="incluirQRCode">Incluir QR Code para confirma√ß√£o de presen√ßa</label>
            </div>

            <div class="form-group" id="linkConfirmacaoGroup" style="display: none; margin-top: 15px;">
              <label for="linkConfirmacao">Link de Confirma√ß√£o:</label>
              <input type="text" id="linkConfirmacao" placeholder="https://exemplo.com/confirmar">
            </div>
          </div>
        </div>

        <!-- Pr√©via do Convite -->
        <div>
          <h2 class="preview-title">Pr√©via do Convite</h2>
          <div class="convite-container template-formal" id="previewContainer">
            <div class="header">
              <div class="logo-dual">
                <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/b/bf/Coat_of_arms_of_Brazil.svg/800px-Coat_of_arms_of_Brazil.svg.png" 
                     alt="Bras√£o da Rep√∫blica" 
                     crossorigin="anonymous"
                     onerror="this.style.display='none'">
                <div class="divider"></div>
                <img src="https://crors.org.br/wp-content/uploads/2024/01/cropped-Logo-oficial-CRO-32x32.png" 
                     alt="Logo CRO/RS" 
                     crossorigin="anonymous"
                     onerror="this.src='https://upload.wikimedia.org/wikipedia/commons/thumb/0/07/Caduceus.svg/1200px-Caduceus.svg.png'">
              </div>
              <h1 id="previewTitulo">Convite Formal</h1>
              <div class="sub-title">CRO/RS - Conselho Regional de Odontologia do RS</div>
            </div>
            <div class="content" id="previewContent">
              <span>√â com grande honra que convidamos </span>
              <strong><span id="previewNome" class="placeholder">[Nome do Convidado]</span></strong>
              <span> para o evento especial promovido pelo CRO/RS.</span><br>
              <br>
              <span id="previewMensagem"></span>
              <strong>Data:</strong> <span id="previewData" class="placeholder">[Data do evento]</span><br>
              <strong>Local:</strong> <span id="previewLocal" class="placeholder">[Local do evento]</span><br>
              <strong>Hor√°rio:</strong> <span id="previewHorario" class="placeholder">[Hor√°rio]</span><br>
              <br>
              Contamos com sua presen√ßa para abrilhantar ainda mais este momento de celebra√ß√£o da odontologia ga√∫cha.<br>
            </div>
            <div class="footer">
              Atenciosamente,<br>
              CRO/RS
            </div>
            <div class="qr-code-container" id="qrCodeContainer" style="display: none;">
              <img id="qrCodeImage" src="" alt="QR Code">
              <div class="qr-code-label">Escaneie para confirmar presen√ßa</div>
            </div>
          </div>

          <!-- Action Buttons -->
          <div class="actions-container">
            <h3 class="actions-title">A√ß√µes</h3>
            <div class="action-buttons">
              <button class="btn btn-primary" onclick="downloadPDF()">üìÑ Baixar PDF</button>
              <button class="btn btn-primary" onclick="downloadImage()">üñºÔ∏è Baixar Imagem</button>
              <button class="btn btn-success" onclick="shareWhatsApp()">üì± WhatsApp</button>
              <button class="btn btn-info" onclick="shareEmail()">üìß E-mail</button>
              <button class="btn btn-secondary" onclick="printInvite()">üñ®Ô∏è Imprimir</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script>
    // Show/Hide screens
    function showEditor() {
      document.getElementById('welcomeScreen').classList.add('hidden');
      document.getElementById('editorScreen').classList.add('active');
    }

    // Elementos do formul√°rio
    const nomeConvidadoInput = document.getElementById('nomeConvidado');
    const dataEventoInput = document.getElementById('dataEvento');
    const localEventoInput = document.getElementById('localEvento');
    const horarioEventoInput = document.getElementById('horarioEvento');
    const mensagemPersonalizadaInput = document.getElementById('mensagemPersonalizada');
    const tipoEventoSelect = document.getElementById('tipoEvento');
    const textoModeloSelect = document.getElementById('textoModelo');
    const excelFileInput = document.getElementById('excelFile');
    const incluirQRCodeCheckbox = document.getElementById('incluirQRCode');
    const linkConfirmacaoInput = document.getElementById('linkConfirmacao');

    // Elementos de pr√©via
    const previewNome = document.getElementById('previewNome');
    const previewData = document.getElementById('previewData');
    const previewLocal = document.getElementById('previewLocal');
    const previewHorario = document.getElementById('previewHorario');
    const previewMensagem = document.getElementById('previewMensagem');
    const previewTitulo = document.getElementById('previewTitulo');
    const previewContent = document.getElementById('previewContent');
    const previewContainer = document.getElementById('previewContainer');
    const qrCodeContainer = document.getElementById('qrCodeContainer');

    // Modelos de texto para convites
    const textosModelos = {
      padrao: {
        titulo: 'Convite',
        conteudo: (nome, data, local, horario, mensagem) => `
          <span>√â com grande honra que convidamos </span>
          <strong><span class="${nome ? '' : 'placeholder'}">${nome || '[Nome do Convidado]'}</span></strong>
          <span> para o evento especial promovido pelo CRO/RS.</span><br>
          <br>
          ${mensagem ? mensagem + '<br><br>' : ''}
          <strong>Data:</strong> <span class="${data ? '' : 'placeholder'}">${data || '[Data do evento]'}</span><br>
          <strong>Local:</strong> <span class="${local ? '' : 'placeholder'}">${local || '[Local do evento]'}</span><br>
          <strong>Hor√°rio:</strong> <span class="${horario ? '' : 'placeholder'}">${horario || '[Hor√°rio]'}</span><br>
          <br>
          Contamos com sua presen√ßa para abrilhantar ainda mais este momento de celebra√ß√£o da odontologia ga√∫cha.<br>
        `
      },
      cientifico: {
        titulo: 'Pr√™mio Cient√≠fico ‚Äì CD Ant√¥nio Augusto Pretto',
        conteudo: (nome, data, local, horario, mensagem) => `
          <span>O Conselho Regional de Odontologia do Rio Grande do Sul - CRO/RS tem a honra de convidar </span>
          <strong><span class="${nome ? '' : 'placeholder'}">${nome || '[Nome do Convidado]'}</span></strong>
          <span> para a cerim√¥nia de entrega do </span><strong>Pr√™mio Cient√≠fico ‚Äì CD Ant√¥nio Augusto Pretto</strong><span>.</span><br>
          <br>
          ${mensagem ? mensagem + '<br><br>' : ''}
          Este pr√™mio homenageia profissionais que se destacaram na pesquisa e desenvolvimento cient√≠fico da Odontologia, 
          contribuindo significativamente para o avan√ßo da profiss√£o.<br>
          <br>
          <strong>Data:</strong> <span class="${data ? '' : 'placeholder'}">${data || '[Data do evento]'}</span><br>
          <strong>Local:</strong> <span class="${local ? '' : 'placeholder'}">${local || '[Local do evento]'}</span><br>
          <strong>Hor√°rio:</strong> <span class="${horario ? '' : 'placeholder'}">${horario || '[Hor√°rio]'}</span><br>
          <br>
          Sua presen√ßa √© muito importante para abrilhantar este momento de reconhecimento e celebra√ß√£o da excel√™ncia cient√≠fica na Odontologia ga√∫cha.<br>
        `
      },
      politico: {
        titulo: 'Pr√™mio Pol√≠tico ‚Äì CD Jair Soares',
        conteudo: (nome, data, local, horario, mensagem) => `
          <span>O Conselho Regional de Odontologia do Rio Grande do Sul - CRO/RS tem a satisfa√ß√£o de convidar </span>
          <strong><span class="${nome ? '' : 'placeholder'}">${nome || '[Nome do Convidado]'}</span></strong>
          <span> para a cerim√¥nia de entrega do </span><strong>Pr√™mio Pol√≠tico ‚Äì CD Jair Soares</strong><span>.</span><br>
          <br>
          ${mensagem ? mensagem + '<br><br>' : ''}
          Este pr√™mio reconhece profissionais que se destacaram na atua√ß√£o pol√≠tica em defesa da Odontologia e dos direitos 
          da classe, fortalecendo a representatividade da profiss√£o perante a sociedade e os √≥rg√£os p√∫blicos.<br>
          <br>
          <strong>Data:</strong> <span class="${data ? '' : 'placeholder'}">${data || '[Data do evento]'}</span><br>
          <strong>Local:</strong> <span class="${local ? '' : 'placeholder'}">${local || '[Local do evento]'}</span><br>
          <strong>Hor√°rio:</strong> <span class="${horario ? '' : 'placeholder'}">${horario || '[Hor√°rio]'}</span><br>
          <br>
          Contamos com sua valorizada presen√ßa neste momento de reconhecimento ao engajamento pol√≠tico em prol da Odontologia.<br>
        `
      },
      social: {
        titulo: 'Pr√™mio Social ‚Äì CD Fl√°vio Ant√¥nio Luce',
        conteudo: (nome, data, local, horario, mensagem) => `
          <span>O Conselho Regional de Odontologia do Rio Grande do Sul - CRO/RS tem a alegria de convidar </span>
          <strong><span class="${nome ? '' : 'placeholder'}">${nome || '[Nome do Convidado]'}</span></strong>
          <span> para a cerim√¥nia de entrega do </span><strong>Pr√™mio Social ‚Äì CD Fl√°vio Ant√¥nio Luce</strong><span>.</span><br>
          <br>
          ${mensagem ? mensagem + '<br><br>' : ''}
          Este pr√™mio homenageia profissionais que se destacaram em a√ß√µes sociais e projetos voltados para o bem-estar 
          da comunidade, levando sa√∫de bucal e dignidade a quem mais precisa.<br>
          <br>
          <strong>Data:</strong> <span class="${data ? '' : 'placeholder'}">${data || '[Data do evento]'}</span><br>
          <strong>Local:</strong> <span class="${local ? '' : 'placeholder'}">${local || '[Local do evento]'}</span><br>
          <strong>Hor√°rio:</strong> <span class="${horario ? '' : 'placeholder'}">${horario || '[Hor√°rio]'}</span><br>
          <br>
          Sua presen√ßa ser√° uma honra neste momento de celebra√ß√£o da solidariedade e do compromisso social da Odontologia ga√∫cha.<br>
        `
      },
      autoridades: {
        titulo: 'Convite Especial',
        conteudo: (nome, data, local, horario, mensagem) => `
          <span>O Conselho Regional de Odontologia do Rio Grande do Sul - CRO/RS, em nome de sua diretoria e de toda a classe odontol√≥gica ga√∫cha, 
          tem a alta honra de convidar </span>
          <strong><span class="${nome ? '' : 'placeholder'}">${nome || '[Nome da Autoridade]'}</span></strong>
          <span> para participar de nossa cerim√¥nia solene.</span><br>
          <br>
          ${mensagem ? mensagem + '<br><br>' : ''}
          Ser√° um momento de grande import√¢ncia para a Odontologia do Rio Grande do Sul, e a presen√ßa de Vossa Excel√™ncia 
          engrandecer√° ainda mais esta ocasi√£o.<br>
          <br>
          <strong>Data:</strong> <span class="${data ? '' : 'placeholder'}">${data || '[Data do evento]'}</span><br>
          <strong>Local:</strong> <span class="${local ? '' : 'placeholder'}">${local || '[Local do evento]'}</span><br>
          <strong>Hor√°rio:</strong> <span class="${horario ? '' : 'placeholder'}">${horario || '[Hor√°rio]'}</span><br>
          <br>
          Respeitosamente, aguardamos sua confirma√ß√£o de presen√ßa.<br>
        `
      },
      remidos: {
        titulo: 'Homenagem aos Remidos',
        conteudo: (nome, data, local, horario, mensagem) => `
          <span>O Conselho Regional de Odontologia do Rio Grande do Sul - CRO/RS tem o privil√©gio de convidar </span>
          <strong><span class="${nome ? '' : 'placeholder'}">${nome || '[Nome do Convidado]'}</span></strong>
          <span> para a </span><strong>Cerim√¥nia de Homenagem aos Remidos</strong><span>.</span><br>
          <br>
          ${mensagem ? mensagem + '<br><br>' : ''}
          Este √© um momento especial para homenagear os cirurgi√µes-dentistas que, com dedica√ß√£o e compromisso, 
          constru√≠ram uma carreira exemplar e contribu√≠ram significativamente para o desenvolvimento da Odontologia em nosso Estado.<br>
          <br>
          <strong>Data:</strong> <span class="${data ? '' : 'placeholder'}">${data || '[Data do evento]'}</span><br>
          <strong>Local:</strong> <span class="${local ? '' : 'placeholder'}">${local || '[Local do evento]'}</span><br>
          <strong>Hor√°rio:</strong> <span class="${horario ? '' : 'placeholder'}">${horario || '[Hor√°rio]'}</span><br>
          <br>
          Sua presen√ßa √© fundamental para celebrar esta trajet√≥ria de dedica√ß√£o e excel√™ncia profissional.<br>
        `
      }
    };

    // Template selection
    const templateOptions = document.querySelectorAll('.template-option');
    const templateRadios = document.querySelectorAll('input[name="template"]');

    templateOptions.forEach(option => {
      option.addEventListener('click', function() {
        templateOptions.forEach(opt => opt.classList.remove('active'));
        this.classList.add('active');
        this.querySelector('input[type="radio"]').checked = true;
        updateTemplate();
      });
    });

    function updateTemplate() {
      const selectedTemplate = document.querySelector('input[name="template"]:checked').value;
      previewContainer.className = 'convite-container template-' + selectedTemplate;
      
      // Update title based on template
      const titles = {
        'formal': 'Convite Formal',
        'modern': 'Convite',
        'classic': 'Convite Especial',
        'minimalist': 'Convite'
      };
      previewTitulo.textContent = titles[selectedTemplate] || 'Convite';
    }

    // Fun√ß√£o para atualizar a pr√©via
    function atualizarPrevia() {
      const nome = nomeConvidadoInput.value.trim();
      const data = dataEventoInput.value.trim();
      const local = localEventoInput.value.trim();
      const horario = horarioEventoInput.value.trim();
      const mensagem = mensagemPersonalizadaInput.value.trim();
      const modeloTexto = textoModeloSelect.value;

      // Atualizar t√≠tulo baseado no modelo de texto
      const modelo = textosModelos[modeloTexto];
      previewTitulo.textContent = modelo.titulo;

      // Atualizar conte√∫do usando o modelo de texto
      previewContent.innerHTML = modelo.conteudo(nome, data, local, horario, mensagem);
    }

    // Excel Import Functionality
    excelFileInput.addEventListener('change', function(e) {
      const file = e.target.files[0];
      if (!file) return;

      const reader = new FileReader();
      reader.onload = function(e) {
        try {
          const data = new Uint8Array(e.target.result);
          const workbook = XLSX.read(data, { type: 'array' });
          
          // Get first sheet
          const firstSheetName = workbook.SheetNames[0];
          const worksheet = workbook.Sheets[firstSheetName];
          
          // Convert to JSON
          const jsonData = XLSX.utils.sheet_to_json(worksheet);
          
          if (jsonData.length > 0) {
            const firstRow = jsonData[0];
            
            // Try to find columns with common names (case insensitive)
            const findColumn = (row, possibleNames) => {
              for (let key in row) {
                if (possibleNames.some(name => key.toLowerCase().includes(name.toLowerCase()))) {
                  return row[key];
                }
              }
              return '';
            };
            
            // Auto-fill form fields
            const nome = findColumn(firstRow, ['nome', 'name', 'convidado']);
            const data = findColumn(firstRow, ['data', 'date', 'dia']);
            const local = findColumn(firstRow, ['local', 'lugar', 'location', 'endere√ßo', 'endereco']);
            const horario = findColumn(firstRow, ['hor√°rio', 'horario', 'hora', 'time']);
            
            if (nome) nomeConvidadoInput.value = nome;
            if (data) dataEventoInput.value = data;
            if (local) localEventoInput.value = local;
            if (horario) horarioEventoInput.value = horario;
            
            // Update preview
            atualizarPrevia();
            
            alert('Dados importados com sucesso! Primeira linha do arquivo foi carregada.');
          } else {
            alert('O arquivo Excel est√° vazio.');
          }
        } catch (error) {
          console.error('Erro ao processar arquivo:', error);
          alert('Erro ao processar arquivo Excel. Verifique se o formato est√° correto.');
        }
      };
      
      reader.readAsArrayBuffer(file);
    });

    // QR Code functionality
    incluirQRCodeCheckbox.addEventListener('change', function() {
      const linkGroup = document.getElementById('linkConfirmacaoGroup');
      if (this.checked) {
        linkGroup.style.display = 'block';
      } else {
        linkGroup.style.display = 'none';
        qrCodeContainer.style.display = 'none';
      }
    });

    linkConfirmacaoInput.addEventListener('input', function() {
      if (incluirQRCodeCheckbox.checked && this.value.trim()) {
        generateQRCode(this.value);
        qrCodeContainer.style.display = 'block';
      } else {
        qrCodeContainer.style.display = 'none';
      }
    });

    let qrCode = null;
    function generateQRCode(url) {
      const qrElement = document.getElementById('qrCodeImage');
      
      // Clear previous QR code
      if (qrCode) {
        qrElement.parentElement.querySelector('#qrcode-temp')?.remove();
      }
      
      // Create temporary container
      const tempDiv = document.createElement('div');
      tempDiv.id = 'qrcode-temp';
      tempDiv.style.display = 'none';
      document.body.appendChild(tempDiv);
      
      // Generate QR code
      qrCode = new QRCode(tempDiv, {
        text: url,
        width: 120,
        height: 120
      });
      
      // Wait for QR code to be generated and then get the image
      setTimeout(() => {
        const img = tempDiv.querySelector('img');
        if (img) {
          qrElement.src = img.src;
        }
      }, 100);
    }

    // Action functions
    function downloadPDF() {
      const { jsPDF } = window.jspdf;
      
      html2canvas(previewContainer, {
        scale: 2,
        useCORS: true,
        logging: false
      }).then(canvas => {
        const imgData = canvas.toDataURL('image/png');
        const pdf = new jsPDF({
          orientation: 'portrait',
          unit: 'mm',
          format: 'a4'
        });
        
        const imgWidth = 190;
        const imgHeight = (canvas.height * imgWidth) / canvas.width;
        const x = 10;
        const y = 10;
        
        pdf.addImage(imgData, 'PNG', x, y, imgWidth, imgHeight);
        pdf.save('convite-cro-rs.pdf');
      });
    }

    function downloadImage() {
      html2canvas(previewContainer, {
        scale: 2,
        useCORS: true,
        logging: false
      }).then(canvas => {
        const link = document.createElement('a');
        link.download = 'convite-cro-rs.png';
        link.href = canvas.toDataURL('image/png');
        link.click();
      });
    }

    function shareWhatsApp() {
      const nome = nomeConvidadoInput.value || '[Nome]';
      const data = dataEventoInput.value || '[Data]';
      const local = localEventoInput.value || '[Local]';
      const horario = horarioEventoInput.value || '[Hor√°rio]';
      const tipoEvento = tipoEventoSelect.options[tipoEventoSelect.selectedIndex].text;
      
      const mensagem = `üéâ Convite Especial - CRO/RS üéâ%0A%0A` +
                      `Convidado: ${nome}%0A` +
                      `Tipo de Evento: ${tipoEvento}%0A` +
                      `Data: ${data}%0A` +
                      `Local: ${local}%0A` +
                      `Hor√°rio: ${horario}%0A%0A` +
                      `Contamos com sua presen√ßa!`;
      
      window.open(`https://wa.me/?text=${mensagem}`, '_blank');
    }

    function shareEmail() {
      const nome = nomeConvidadoInput.value || '[Nome]';
      const data = dataEventoInput.value || '[Data]';
      const local = localEventoInput.value || '[Local]';
      const horario = horarioEventoInput.value || '[Hor√°rio]';
      const tipoEvento = tipoEventoSelect.options[tipoEventoSelect.selectedIndex].text;
      
      const assunto = `Convite: ${tipoEvento} - CRO/RS`;
      const corpo = `Prezado(a) ${nome},%0A%0A` +
                   `√â com grande honra que convidamos V.Sa. para o evento especial promovido pelo CRO/RS.%0A%0A` +
                   `Tipo de Evento: ${tipoEvento}%0A` +
                   `Data: ${data}%0A` +
                   `Local: ${local}%0A` +
                   `Hor√°rio: ${horario}%0A%0A` +
                   `Contamos com sua presen√ßa para abrilhantar ainda mais este momento de celebra√ß√£o da odontologia ga√∫cha.%0A%0A` +
                   `Atenciosamente,%0ACRO/RS`;
      
      window.location.href = `mailto:?subject=${assunto}&body=${corpo}`;
    }

    function printInvite() {
      window.print();
    }

    // Adicionar event listeners para atualiza√ß√£o em tempo real
    nomeConvidadoInput.addEventListener('input', atualizarPrevia);
    dataEventoInput.addEventListener('input', atualizarPrevia);
    localEventoInput.addEventListener('input', atualizarPrevia);
    horarioEventoInput.addEventListener('input', atualizarPrevia);
    mensagemPersonalizadaInput.addEventListener('input', atualizarPrevia);
    tipoEventoSelect.addEventListener('change', atualizarPrevia);
    textoModeloSelect.addEventListener('change', atualizarPrevia);

    // Inicializar pr√©via
    atualizarPrevia();
  </script>
</body>
</html>
